<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>แบบทดสอบความรู้เภสัชกรรมเชิงโต้ตอบ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=sarabun:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Chosen Palette: Calm Harmony (Background: Stone-100, Text: Stone-800, Primary Action: Teal-500, Correct: Green-100/800, Incorrect: Red-100/800) -->
    <!-- Application Structure Plan: A single-page quiz application designed for active learning. The structure features a welcome screen, a one-question-at-a-time quiz view with immediate feedback, and a final results summary. Key interactions include selecting an answer to get instant rationale, navigating between questions, filtering questions by clinical category, and viewing a graphical summary of performance. This structure was chosen to transform the static test into an engaging, focused learning tool that provides immediate reinforcement and highlights knowledge gaps, which is more effective for retention than a simple list of questions and answers. -->
    <!-- Visualization & Content Choices: Questions/Answers -> Goal: Assess -> Presentation: Interactive Radio Buttons -> Interaction: Click to select & get immediate feedback -> Justification: Active learning loop. Categories -> Goal: Organize -> Presentation: Filter Buttons -> Interaction: Click to filter quiz content -> Justification: Allows targeted practice. Performance Summary -> Goal: Summarize -> Viz: Chart.js Doughnut Chart -> Interaction: Hover to see details -> Justification: Provides a quick, visual, and impactful summary of strengths/weaknesses by category. All visual elements are built with HTML/Tailwind or rendered on a Canvas element via Chart.js, confirming NO SVG/Mermaid JS used. -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body {
            font-family: 'Sarabun', sans-serif;
        }
        .chart-container {
            position: relative;
            margin: auto;
            height: 350px;
            width: 100%;
            max-width: 400px;
        }
        .option.correct {
            background-color: #dcfce7;
            border-color: #22c55e;
            color: #166534;
        }
        .option.incorrect {
            background-color: #fee2e2;
            border-color: #ef4444;
            color: #991b1b;
        }
        .option:not(.disabled):hover {
            background-color: #f0f9ff;
            border-color: #38bdf8;
        }
        .option.disabled {
            cursor: not-allowed;
            opacity: 0.8;
        }
        .feedback-correct {
            border-left-color: #22c55e;
        }
        .feedback-incorrect {
            border-left-color: #ef4444;
        }
    </style>
</head>
<body class="bg-stone-100 text-stone-800">

    <div id="app" class="max-w-4xl mx-auto p-4 sm:p-6 lg:p-8">
        
        <!-- Welcome Screen -->
        <div id="welcome-screen" class="text-center">
            <h1 class="text-3xl sm:text-4xl font-bold text-teal-700 mb-4">แบบทดสอบความรู้ทางเภสัชกรรม</h1>
            <p class="text-lg text-stone-600 mb-8">ฉบับประยุกต์ขั้นสูง: ทดสอบความสามารถในการประยุกต์ใช้ความรู้ทางคลินิกในสถานการณ์ที่ซับซ้อน</p>
            <button onclick="startQuiz('all')" class="bg-teal-600 hover:bg-teal-700 text-white font-bold py-3 px-8 rounded-lg shadow-md transition-transform transform hover:scale-105">
                เริ่มทำแบบทดสอบทั้งหมด (40 ข้อ)
            </button>
            <div class="mt-10">
                <h2 class="text-2xl font-semibold text-stone-700 mb-4">หรือเลือกทำเฉพาะหมวด</h2>
                 <div id="category-buttons" class="flex flex-wrap justify-center gap-3">
                    <!-- Category buttons will be inserted here by JS -->
                </div>
            </div>
        </div>

        <!-- Quiz Screen -->
        <div id="quiz-screen" class="hidden">
            <div class="flex justify-between items-center mb-4">
                <div id="question-counter" class="text-lg font-semibold text-teal-700"></div>
                <button onclick="showWelcomeScreen()" class="text-sm bg-stone-200 hover:bg-stone-300 text-stone-700 font-semibold py-1 px-3 rounded-md">กลับไปหน้าแรก</button>
            </div>
            
            <div class="w-full bg-stone-200 rounded-full h-2.5 mb-6">
                <div id="progress-bar" class="bg-teal-500 h-2.5 rounded-full" style="width: 0%"></div>
            </div>

            <div class="bg-white p-6 sm:p-8 rounded-xl shadow-lg">
                <h2 id="question-text" class="text-xl sm:text-2xl font-bold mb-6 leading-relaxed"></h2>
                <div id="options-container" class="space-y-4"></div>
            </div>

            <div id="feedback-container" class="hidden mt-6 bg-white p-5 rounded-lg shadow-lg border-l-4">
                <h3 id="feedback-title" class="text-lg font-bold mb-2"></h3>
                <p id="feedback-text" class="text-stone-700 leading-relaxed"></p>
            </div>
            
            <div class="mt-8 text-center">
                <button id="next-button" onclick="nextQuestion()" class="hidden bg-teal-600 hover:bg-teal-700 text-white font-bold py-3 px-8 rounded-lg shadow-md transition-transform transform hover:scale-105">
                    ข้อถัดไป
                </button>
            </div>
        </div>

        <!-- Results Screen -->
        <div id="results-screen" class="hidden text-center">
            <h1 class="text-3xl sm:text-4xl font-bold text-teal-700 mb-4">สรุปผลการทดสอบ</h1>
            <p id="score-text" class="text-2xl text-stone-600 mb-8"></p>
            <div class="bg-white p-6 rounded-xl shadow-lg mb-8">
                 <h2 class="text-2xl font-semibold text-stone-700 mb-4">สรุปผลตามหมวดหมู่</h2>
                <div class="chart-container">
                    <canvas id="results-chart"></canvas>
                </div>
            </div>
            <button onclick="showWelcomeScreen()" class="bg-teal-600 hover:bg-teal-700 text-white font-bold py-3 px-8 rounded-lg shadow-md transition-transform transform hover:scale-105">
                ทำแบบทดสอบอีกครั้ง
            </button>
        </div>

    </div>

    <script>
        const quizData = [
            {
                category: "โรคหัวใจและหลอดเลือด",
                question: "ผู้ป่วยชายอายุ 68 ปี มีประวัติโรคหัวใจล้มเหลว (HFrEF), โรคไตเรื้อรังระยะที่ 3 และภาวะโปแตสเซียมในเลือดสูง (K+ 5.8 mEq/L) กำลังรับประทานยา Warfarin, Ramipril และ Bisoprolol แพทย์ต้องการจัดการภาวะ Hyperkalemia เพื่อให้สามารถใช้ยา Ramipril ต่อไปได้ ข้อใดคือการดำเนินการที่เหมาะสมที่สุด?",
                options: [
                    "แนะนำให้หยุด Ramipril ชั่วคราวและเริ่ม Furosemide เพื่อขับโปแตสเซียม",
                    "แนะนำให้ใช้ Kalimate เนื่องจากเป็นยามาตรฐานและผู้ป่วยมีภาวะบวมน้ำ",
                    "แนะนำให้ใช้ Lokelma เนื่องจากออกฤทธิ์เร็ว มีปฏิกิริยากับยาอื่นน้อย และจำเพาะต่อการจับโปแตสเซียม",
                    "แนะนำให้ลดขนาดยา Warfarin ลง 50% แล้วเริ่มใช้ยาขับโปแตสเซียมตัวใดก็ได้",
                    "แนะนำให้เปลี่ยนจาก Ramipril เป็น Fimasartan เนื่องจากมีผลต่อโปแตสเซียมน้อยกว่า"
                ],
                correct: 2,
                explanation: "ในสถานการณ์ที่ซับซ้อนนี้ การเลือกใช้ Lokelma ช่วยแก้ปัญหา Hyperkalemia ได้อย่างตรงจุดโดยไม่กระทบต่อยา Warfarin และช่วยให้สามารถใช้ยา Ramipril ซึ่งจำเป็นสำหรับ HFrEF ต่อไปได้ การใช้ยาขับปัสสาวะอาจไม่เพียงพอและ Kalimate มีปฏิกิริยากับยา Warfarin"
            },
             {
                category: "โรคหัวใจและหลอดเลือด",
                question: "ผู้ป่วยความดันโลหิตสูงได้รับยา Kanarb (Fimasartan) 60 mg ร่วมกับ HCTZ 12.5 mg แต่ความดันยังคงอยู่ที่ 155/95 mmHg. ผลเลือดล่าสุดพบ eGFR 55 mL/min/1.73m² และ K+ 4.9 mEq/L. ข้อใดคือการปรับยาที่เหมาะสมที่สุดตามหลักฐานเชิงประจักษ์?",
                options: [
                    "เพิ่มขนาดยา Kanarb เป็น 120 mg วันละครั้ง",
                    "เพิ่มยา Amlodipine 5 mg เข้าไปในสูตรการรักษา",
                    "เปลี่ยน Kanarb เป็น Olmesartan 40 mg เนื่องจากมีฤทธิ์แรงกว่า",
                    "เพิ่มขนาดยา HCTZ เป็น 25 mg เพื่อเสริมฤทธิ์ลดความดัน",
                    "คงยาเดิมและแนะนำให้ปรับเปลี่ยนพฤติกรรมอย่างเข้มงวดเป็นเวลา 3 เดือน"
                ],
                correct: 0,
                explanation: "ตามแนวทางการรักษา ควรปรับขนาดยาในกลุ่ม ARB ให้ถึงขนาดสูงสุดที่แนะนำ (120 mg) ก่อนที่จะพิจารณาเพิ่มยาตัวที่สามเข้าไปในสูตรการรักษา เพื่อให้ได้ประสิทธิภาพสูงสุดจากยาพื้นฐาน"
            },
            {
                category: "โรคหัวใจและหลอดเลือด",
                question: "ผู้ป่วยชายอายุ 60 ปี เข้ารับการรักษาด้วย STEMI และกำลังจะได้รับการทำ PCI. ตามโปรโตคอลของโรงพยาบาลต้องให้ Enoxaparin แต่มีจำหน่ายเฉพาะ Enoxaparin Stada 60 mg/0.6 mL PFS. พยาบาลกังวลว่าสามารถใช้ทดแทน Clexane ที่ระบุในโปรโตคอลได้หรือไม่. ท่านจะให้ข้อมูลอย่างไร?",
                options: [
                    "ไม่สามารถใช้แทนได้ เนื่องจากโปรโตคอลระบุชื่อการค้า Clexane ชัดเจน",
                    "ใช้แทนได้ แต่ต้องแจ้งแพทย์เพื่อปรับขนาดยา เนื่องจากอาจมีความแรงไม่เท่ากัน",
                    "ใช้แทนได้โดยไม่ต้องปรับขนาดยา เนื่องจากเป็นยาที่มีประสิทธิผลทัดเทียมกัน (Therapeutic Equivalence) ตามการรับรองของ US FDA",
                    "ใช้แทนได้ แต่ต้องติดตามค่า aPTT อย่างใกล้ชิด ซึ่งแตกต่างจากการใช้ Clexane",
                    "แนะนำให้รอ Clexane จากคลังยา เพื่อความปลอดภัยสูงสุดของผู้ป่วย"
                ],
                correct: 2,
                explanation: "การเข้าใจและประยุกต์ใช้ข้อมูล \"Interchangable with Clexane (US FDA approved therapeutic equivalence)\" ในสถานการณ์ฉุกเฉินและมีความเสี่ยงสูงเป็นสิ่งสำคัญ เพื่อให้ผู้ป่วยได้รับการรักษาที่ทันท่วงที"
            },
            {
                category: "โรคหัวใจและหลอดเลือด",
                question: "ผู้ป่วยชายอายุ 55 ปี มีผลเลือด LDL-C 130 mg/dL และ Triglyceride 250 mg/dL ได้รับยา Atozet 10/20 mg. แพทย์ต้องการควบคุมระดับไขมันให้ดียิ่งขึ้น ข้อใดเป็นการปรับยาที่เหมาะสมที่สุดเป็นลำดับแรก?",
                options: [
                    "เพิ่มยา Fenofibrate เพื่อควบคุมระดับ Triglyceride",
                    "เปลี่ยนเป็น Atozet 10/40 mg",
                    "เปลี่ยนเป็น Livalo (Pitavastatin) 4 mg และ Ezetimibe 10 mg",
                    "แนะนำให้เพิ่ม Fish oil ขนาดสูง",
                    "เพิ่มขนาดยา Atozet 10/20 mg เป็นวันละ 2 ครั้ง"
                ],
                correct: 1,
                explanation: "เป้าหมายหลักในการรักษาคือการลด LDL-C การเพิ่มความแรงของ Statin (Atorvastatin จาก 20 เป็น 40 mg) เป็นขั้นตอนแรกที่ควรทำก่อนพิจารณาเพิ่มยาสำหรับลด Triglyceride โดยตรง"
            },
            {
                category: "โรคหัวใจและหลอดเลือด",
                question: "ผู้ป่วยโรค PAH (Pulmonary Arterial Hypertension) WHO Functional class II ได้รับการสั่งใช้ยา Opsumit (Macitentan) ผู้ป่วยมีประวัติค่าเอนไซม์ตับ (AST/ALT) สูงกว่าค่าปกติเล็กน้อย ข้อใดคือการให้ข้อมูลและการเฝ้าระวังที่สำคัญที่สุดก่อนเริ่มยา?",
                options: [
                    "แจ้งว่ายานี้เบิกไม่ได้ในทุกสิทธิ และเป็นยา Non-stock",
                    "แนะนำให้รับประทานยาพร้อมอาหารเพื่อลดผลข้างเคียงต่อตับ",
                    "แจ้งแพทย์ถึงความจำเป็นในการตรวจติดตามการทำงานของตับอย่างใกล้ชิดก่อนและระหว่างการรักษา",
                    "ทวนสอบกับแพทย์เฉพาะทางด้านโรคหัวใจเท่านั้น เนื่องจากแพทย์สาขาอื่นไม่มีสิทธิ์สั่ง",
                    "แนะนำให้เริ่มยาในขนาดครึ่งหนึ่งก่อนเพื่อประเมินการตอบสนองของตับ"
                ],
                correct: 2,
                explanation: "ยาในกลุ่ม Endothelin Receptor Antagonists (ERAs) เช่น Macitentan มีความเสี่ยงต่อการเกิดพิษต่อตับ การเฝ้าระวังการทำงานของตับในผู้ป่วยที่มีความเสี่ยงอยู่แล้วจึงเป็นสิ่งสำคัญที่สุดทางคลินิก"
            },
            {
                category: "โรคต่อมไร้ท่อ",
                question: "ผู้ป่วยเบาหวานชนิดที่ 1 ใช้อินซูลินปั๊ม (Insulin Pump) บรรจุยา Novorapid พบว่ายังมีระดับน้ำตาลหลังอาหารสูงอย่างสม่ำเสมอ (Postprandial hyperglycemia) แม้ว่าจะคำนวณ Bolus dose ถูกต้องแล้ว ข้อใดคือคำแนะนำทางเภสัชจลนศาสตร์ที่ควรพิจารณา?",
                options: [
                    "แนะนำให้เปลี่ยนไปใช้ Regular insulin ในปั๊มแทน เพราะออกฤทธิ์นานกว่า",
                    "แนะนำให้ผู้ป่วยตั้งโปรแกรม \"Pre-bolus\" หรือฉีดอินซูลินล่วงหน้าก่อนมื้ออาหาร 15-20 นาที",
                    "แนะนำให้เพิ่ม Basal rate ในช่วงหลังอาหาร",
                    "แนะนำว่า Novorapid ไม่เหมาะกับปั๊ม ควรเปลี่ยนเป็น Lantus",
                    "แนะนำให้เปลี่ยนตำแหน่งที่ติดปั๊มทุกครั้งที่ฉีด"
                ],
                correct: 1,
                explanation: "แม้ว่า Novorapid (Insulin Aspart) จะออกฤทธิ์เร็ว แต่ก็ยังต้องใช้เวลาในการดูดซึม การฉีดล่วงหน้า (Pre-bolus) จะช่วยให้ระดับอินซูลินในเลือดขึ้นสูงสุดพร้อมกับระดับน้ำตาลที่ขึ้นสูงสุดจากอาหารได้ดีขึ้น"
            },
            {
                category: "โรคต่อมไร้ท่อ",
                question: "ผู้ป่วยนำยา Lantus SoloStar ที่ยังไม่เปิดใช้มาคืนห้องยา โดยแจ้งว่าเผลอนำไปเก็บในช่องแช่แข็งของตู้เย็นเป็นเวลา 1 คืน จนอินซูลินแข็งตัว แต่ตอนนี้ละลายเป็นของเหลวใสเหมือนเดิมแล้ว ท่านควรจัดการอย่างไร?",
                options: [
                    "รับยาคืนและแนะนำให้ผู้ป่วยเบิกหลอดใหม่ เนื่องจากอินซูลินที่ผ่านการแช่แข็งจะเสื่อมสภาพ",
                    "แจ้งผู้ป่วยว่ายังสามารถใช้ยาได้ แต่ต้องเขย่าให้ยาเข้ากันดีก่อนใช้",
                    "แจ้งผู้ป่วยว่ายังสามารถใช้ยาได้ แต่ประสิทธิภาพอาจลดลง ควรติดตามระดับน้ำตาลอย่างใกล้ชิด",
                    "แนะนำให้นำไปเก็บในช่องธรรมดาต่อ และสังเกตว่ามีตะกอนหรือไม่ หากไม่มีก็ใช้ได้",
                    "รับยาคืนและนำกลับเข้าคลังยาเพื่อจ่ายให้ผู้ป่วยรายอื่นต่อไป"
                ],
                correct: 0,
                explanation: "การแช่แข็งทำลายโครงสร้างโปรตีนของอินซูลินอย่างถาวร แม้ว่าจะกลับมาเป็นของเหลวใส แต่ยาจะสูญเสียประสิทธิภาพและไม่สามารถคาดเดาการออกฤทธิ์ได้ ถือเป็นยาเสื่อมสภาพและต้องทิ้ง"
            },
            {
                category: "โรคต่อมไร้ท่อ",
                question: "ผู้ป่วยเด็กอายุ 3 ปี ที่ใช้ Lantus SoloStar มีภาวะน้ำตาลในเลือดต่ำตอนกลางคืน (Nocturnal hypoglycemia) โดยไม่ทราบสาเหตุบ่อยครั้ง ข้อใดคือคุณสมบัติทางเภสัชจลนศาสตร์ของ Insulin glargine 100 iu/mL ที่อาจเกี่ยวข้องกับปัญหานี้?",
                options: [
                    "ยามีระยะเวลาออกฤทธิ์สั้นเกินไป ทำให้เกิดภาวะน้ำตาลสูงในตอนเช้า",
                    "ยามีการออกฤทธิ์สูงสุด (Peak effect) เล็กน้อย ซึ่งอาจเกิดขึ้นในช่วงกลางคืน",
                    "ยาถูกดูดซึมได้ไม่ดีในเด็กเล็ก ทำให้การออกฤทธิ์ไม่สม่ำเสมอ",
                    "ยาไม่สามารถใช้ร่วมกับอินซูลินชนิดออกฤทธิ์เร็วได้",
                    "ยามีคุณสมบัติเป็นกรด ทำให้เกิดการระคายเคืองและดูดซึมผิดปกติ"
                ],
                correct: 1,
                explanation: "แม้ว่า Insulin glargine U100 จะถูกออกแบบมาให้มีฤทธิ์ค่อนข้างราบเรียบ แต่ก็ยังมี peak การออกฤทธิ์เล็กน้อยได้ในผู้ป่วยบางราย ซึ่งหากเกิดขึ้นในช่วงที่ผู้ป่วยนอนหลับ อาจเป็นสาเหตุของภาวะน้ำตาลในเลือดต่ำได้"
            },
            {
                category: "โรคมะเร็ง",
                question: "ผู้ป่วยมะเร็งปอด NSCLC ที่มีเส้นเลือดเปราะ (poor venous access) และกำลังรับประทานยา Carbamazepine เพื่อรักษาอาการชัก แพทย์พิจารณาให้ยา Vinorelbine ท่านจะให้คำปรึกษาที่ครอบคลุมที่สุดอย่างไร?",
                options: [
                    "แนะนำให้พิจารณา Vinorelbine รูปแบบรับประทานเพื่อแก้ปัญหาเรื่องเส้นเลือด และแจ้งเตือนเรื่องปฏิกิริยาระหว่างยาที่อาจเกิดขึ้น",
                    "แนะนำให้ใส่สายสวนหลอดเลือดดำส่วนกลาง (central line) เพื่อให้ยา Vinorelbine ชนิดฉีดอย่างปลอดภัย",
                    "แนะนำให้หยุดยา Carbamazepine ก่อนเริ่มให้ยา Vinorelbine ชนิดฉีด",
                    "แจ้งว่าไม่สามารถให้ยา Vinorelbine ได้ เนื่องจากมีความเสี่ยงสูงเกินไป",
                    "แนะนำให้ลดขนาดยา Vinorelbine ชนิดฉีดลงครึ่งหนึ่งเพื่อลดความเสี่ยงทั้งสองด้าน"
                ],
                correct: 0,
                explanation: "คำตอบนี้แก้ไขปัญหาทั้งสองอย่างพร้อมกัน คือ (1) ใช้ข้อมูลจากหมายเหตุยาเรื่องรูปแบบรับประทานเพื่อแก้ปัญหา extravasation และ (2) ตระหนักว่า Carbamazepine เป็น CYP3A4 inducer ซึ่งอาจลดประสิทธิภาพของ Vinorelbine ได้"
            },
            {
                category: "โรคมะเร็ง",
                question: "ผู้ป่วยมะเร็งเต้านมระยะแพร่กระจายชนิด HER2-low ที่เคยได้รับการรักษาด้วยเคมีบำบัดมาก่อน แพทย์พิจารณาสั่งยา Enhertu ผู้ป่วยมีสิทธิข้าราชการ ข้อใดคืออุปสรรคสำคัญที่สุดในการเริ่มการรักษาที่เภสัชกรต้องแจ้งให้ทีมรักษาทราบ?",
                options: [
                    "ยานี้มีผลข้างเคียงรุนแรงต่อปอด (Interstitial Lung Disease) ต้องเฝ้าระวังเป็นพิเศษ",
                    "ยานี้ต้องบริหารร่วมกับยาอื่นในกลุ่ม HER2-targeted therapy",
                    "ยานี้เป็นยา Non-stock และไม่สามารถเบิกจ่ายจากกรมบัญชีกลางได้",
                    "ผู้ป่วยต้องมีผลการตรวจยีน HER2-positive เท่านั้นจึงจะใช้ยาได้",
                    "ยานี้ต้องเก็บในตู้เย็นที่ควบคุมอุณหภูมิอย่างเข้มงวด ทำให้การจัดการยุ่งยาก"
                ],
                correct: 2,
                explanation: "แม้ว่าข้อ ก. จะเป็นข้อกังวลทางคลินิกที่สำคัญ แต่ในทางปฏิบัติ อุปสรรคด้านการเข้าถึงยา (สถานะ Non-stock) และภาระค่าใช้จ่าย (เบิกไม่ได้) เป็นประเด็นแรกสุดที่ต้องจัดการก่อนเริ่มการรักษาได้"
            },
            {
                category: "โรคมะเร็ง",
                question: "ผู้ป่วย nmCRPC สิทธิข้าราชการ มีประวัติการแพ้ยา Enzalutamide อย่างรุนแรง (เกิดอาการชัก) แพทย์เสนอให้ใช้ยา Nubeqa (Darolutamide) ท่านจะให้ความเห็นอย่างไร?",
                options: [
                    "เห็นด้วย เนื่องจาก Nubeqa เป็นทางเลือกที่เหมาะสม และควรแจ้งว่ายานี้เบิกไม่ได้",
                    "ไม่เห็นด้วย ควรลองใช้ Enzalutamide อีกครั้งในขนาดที่ต่ำลง",
                    "ไม่เห็นด้วย เนื่องจาก Nubeqa และ Enzalutamide อยู่ในกลุ่มยาเดียวกัน มีโอกาสแพ้ข้ามกลุ่มสูง",
                    "เห็นด้วย และยานี้น่าจะเบิกได้เนื่องจากผู้ป่วยมีข้อห้ามในการใช้ยาในระบบ OCPA",
                    "แนะนำให้เปลี่ยนไปใช้ยา Abiraterone แทน เนื่องจากมีความปลอดภัยสูงกว่า"
                ],
                correct: 0,
                explanation: "ในกรณีที่มีข้อห้ามใช้ยา Enzalutamide ซึ่งเป็นยาที่แนะนำก่อนในสิทธิข้าราชการ การเลือกใช้ Nubeqa จึงสมเหตุสมผลทางคลินิก แต่เภสัชกรยังคงต้องให้ข้อมูลที่ถูกต้องเกี่ยวกับสถานะการเบิกจ่ายของยา"
            },
            {
                category: "โรคมะเร็ง",
                question: "ผู้ป่วย MDS กลุ่ม High-Risk สิทธิข้าราชการ ได้รับการสั่งยา Decitabine (Decitex) ผู้ป่วยสอบถามว่าขั้นตอนการ \"สำรองจ่าย\" หมายความว่าอย่างไร ท่านจะอธิบายอย่างไรให้ชัดเจนที่สุด?",
                options: [
                    "หมายถึงโรงพยาบาลจะจ่ายค่ายาให้ก่อน แล้วไปเรียกเก็บจากกรมบัญชีกลางทีหลัง",
                    "หมายถึงผู้ป่วยต้องชำระเงินค่ายาเต็มจำนวนไปก่อน แล้วจึงนำใบเสร็จไปยื่นเบิกกับหน่วยงานต้นสังกัดในภายหลัง",
                    "หมายถึงยาตัวนี้เป็นยาสำรองในคลัง ไม่ได้มีใช้ตลอด",
                    "หมายถึงผู้ป่วยต้องจ่ายเงินส่วนต่างค่ารักษาพยาบาลที่ไม่ใช่ค่ายา",
                    "หมายถึงกรมบัญชีกลางจะจ่ายค่ายาให้โดยตรง แต่ผู้ป่วยต้องลงทะเบียนล่วงหน้า"
                ],
                correct: 1,
                explanation: "การเข้าใจและสามารถอธิบายกระบวนการทางการเงินที่ซับซ้อนและส่งผลกระทบโดยตรงต่อผู้ป่วยเป็นทักษะที่สำคัญของเภสัชกร"
            },
            {
                category: "โรคมะเร็ง",
                question: "ผู้ป่วย WM ที่รับประทานยา Brukinsa (Zanubrutinib) อยู่ ได้รับการวินิจฉัยว่าเป็นโรคกระเพาะอาหารอักเสบ และได้รับยา Omeprazole ท่านควรให้คำแนะนำเพิ่มเติมอย่างไร?",
                options: [
                    "แนะนำให้รับประทาน Brukinsa พร้อมอาหารเพื่อลดการระคายเคืองกระเพาะ",
                    "แนะนำให้รับประทานยาทั้งสองตัวห่างกันอย่างน้อย 2 ชั่วโมง",
                    "แจ้งว่าไม่มีปฏิกิริยาระหว่างยาที่สำคัญ สามารถรับประทานร่วมกันได้",
                    "แนะนำให้เปลี่ยนจาก Omeprazole เป็น Famotidine เพื่อหลีกเลี่ยงผลต่อการดูดซึมยา",
                    "ตรวจสอบข้อมูลปฏิกิริยาระหว่างยา เนื่องจากยาที่ลดกรดอาจมีผลต่อการดูดซึมของยาในกลุ่ม BTK inhibitors บางตัว"
                ],
                correct: 4,
                explanation: "แม้ข้อมูลที่ให้มาจะระบุแค่การทานยา Brukinsa กับอาหาร แต่ในทางปฏิบัติ ยาในกลุ่ม BTK inhibitors บางตัว (เช่น Ibrutinib) การดูดซึมจะขึ้นกับ pH ในกระเพาะอาหาร การเริ่มใช้ยา PPIs จึงเป็นข้อควรระวังที่ต้องตรวจสอบเพิ่มเติมเสมอ"
            },
            {
                category: "โรคระบบประสาทและจิตเวช",
                question: "ผู้ป่วยพาร์กินสันที่ใช้ยา Stalevo 200/50/200 mg วันละ 3 ครั้ง มีอาการคลื่นไส้รุนแรงหลังรับประทานยา และสังเกตว่าอาการขยับช้าแย่ลงเมื่อทานยาพร้อมนมโปรตีนสูง ท่านจะให้คำแนะนำเพื่อจัดการปัญหาทั้งสองอย่างนี้อย่างไร?",
                options: [
                    "แนะนำให้ทานยาหลังอาหารทันทีเพื่อลดอาการคลื่นไส้ และหลีกเลี่ยงนม",
                    "แนะนำให้ทานยา 30-60 นาทีก่อนอาหาร และอาจทานร่วมกับยาแก้คลื่นไส้ เช่น Domperidone หากจำเป็น",
                    "แนะนำให้ลดขนาดยา Stalevo ลงเพื่อลดอาการคลื่นไส้",
                    "แนะนำให้เปลี่ยนไปใช้ Amantadine ซึ่งมีผลข้างเคียงน้อยกว่า",
                    "แนะนำให้บดเม็ดยาผสมกับน้ำผลไม้เพื่อลดอาการคลื่นไส้"
                ],
                correct: 1,
                explanation: "คำตอบนี้แก้ไขปัญหาทั้งสองอย่าง: (1) ยืนยันคำแนะนำเดิมเรื่องการทานยาก่อนอาหารเพื่อหลีกเลี่ยงปฏิกิริยากับโปรตีน และ (2) เสนอแนวทางการจัดการผลข้างเคียง (คลื่นไส้) ที่อาจเกิดขึ้นจากการทานยาตอนท้องว่าง"
            },
            {
                category: "โรคระบบประสาทและจิตเวช",
                question: "แพทย์ฝึกหัดจากแผนกอายุรกรรมทั่วไปสั่งยา Amantadine Stada สำหรับผู้ป่วยสูงอายุที่มีอาการสับสนหลังผ่าตัด โดยให้เหตุผลว่าอาจช่วยลดอาการเพ้อ (delirium) ได้ ท่านควรดำเนินการอย่างไร?",
                options: [
                    "จ่ายยาตามสั่ง เนื่องจากมีรายงานการใช้ Amantadine ในภาวะนี้",
                    "ปฏิเสธการจ่ายยา เนื่องจากไม่ใช่ข้อบ่งใช้ที่ได้รับการรับรอง",
                    "ตรวจสอบกับแพทย์ผู้สั่ง แจ้งเงื่อนไขการสั่งใช้ยาโดยแพทย์เฉพาะทาง และทวนสอบข้อบ่งใช้ซึ่งเน้นที่โรคพาร์กินสัน",
                    "จ่ายยาให้ แต่จำกัดจำนวนไม่เกิน 3 วัน",
                    "แนะนำให้ใช้ยา Rexulti แทน เนื่องจากมีข้อบ่งใช้สำหรับ agitation ที่เกี่ยวข้องกับ dementia"
                ],
                correct: 2,
                explanation: "การกระทำนี้แสดงถึงบทบาทของเภสัชกรในการกำกับดูแลการใช้ยาให้เหมาะสม (drug stewardship) โดยการทวนสอบทั้งเงื่อนไขการสั่งจ่ายของโรงพยาบาลและข้อบ่งใช้ของยาที่ถูกต้อง"
            },
            {
                category: "โรคระบบประสาทและจิตเวช",
                question: "ผู้ป่วย Schizophrenia ที่ควบคุมอาการได้ดีด้วยยา Rexulti (Brexpiprazole) 2 mg/day ได้รับการวินิจฉัยว่าเป็นวัณโรคและต้องเริ่มการรักษาด้วยสูตรยาที่มี Rifampicin ท่านคาดว่าจะเกิดปัญหาอะไรขึ้น และควรแนะนำอย่างไร?",
                options: [
                    "ระดับยา Rexulti จะสูงขึ้นจนเกิดพิษ ควรลดขนาดยาลง",
                    "ระดับยา Rexulti จะลดลงจนอาจควบคุมอาการไม่ได้ ควรพิจารณาปรับขนาดยาเพิ่มขึ้น",
                    "Rifampicin จะทำให้เกิดอาการข้างเคียงทางจิตเวชมากขึ้น",
                    "ไม่เกิดปฏิกิริยาระหว่างยาที่สำคัญ แต่ควรติดตามการทำงานของตับ",
                    "แนะนำให้เลื่อนการรักษาวัณโรคออกไปก่อน"
                ],
                correct: 1,
                explanation: "Rifampicin เป็น Strong CYP3A4 inducer ในขณะที่ Rexulti ถูกเมแทบอลิซึมผ่าน CYP3A4 และ CYP2D6 การใช้ร่วมกันจะเร่งการกำจัดยา Rexulti ทำให้ระดับยาลดลงอย่างมีนัยสำคัญและอาจทำให้อาการทางจิตกำเริบ"
            },
            {
                category: "โรคระบบประสาทและจิตเวช",
                question: "ผู้ป่วยที่มีภาวะเลือดออกในสมอง (intracranial hemorrhage) และยังคงมีเลือดออกอยู่ ได้รับการสั่งยา Somazina 1000 mg IV infusion ผสมใน NSS 100 mL ท่านจะให้คำแนะนำเรื่องอัตราการให้ยาแก่พยาบาลอย่างไร?",
                options: [
                    "ให้ยาในอัตรา 2-3 mL/นาที ตามคำแนะนำมาตรฐาน",
                    "ให้ยาในอัตราไม่เกิน 1.5 mL/นาที เนื่องจากผู้ป่วยมีภาวะเลือดออกในสมองที่ยังดำเนินอยู่",
                    "ให้ยาแบบ rapid infusion เพื่อให้ระดับยาสูงขึ้นอย่างรวดเร็ว",
                    "ให้ยาแบบ slow push 5 นาทีแทนการ infusion",
                    "หยุดการให้ยาจนกว่าภาวะเลือดออกจะคงที่"
                ],
                correct: 1,
                explanation: "การสังเกตและประยุกต์ใช้ข้อมูลคำเตือนพิเศษ (In case of persistent intracranial hemorrhage, max rate 1.5 mL/min) ในสถานการณ์ทางคลินิกที่ตรงกับคำเตือนนั้น เป็นทักษะการดูแลผู้ป่วยที่สำคัญ"
            },
            {
                category: "โรคระบบทางเดินอาหารและโภชนาการ",
                question: "ผู้ป่วยโรคตับแข็งที่มีภาวะ Hepatic Encephalopathy และ Hypoalbuminemia ได้รับการสั่งใช้ยา Livact และ Risavie ร่วมกัน ท่านจะให้คำแนะนำในการรับประทานยาแก่ผู้ป่วยอย่างไร?",
                options: [
                    "ให้รับประทานยาทั้งสองชนิดพร้อมอาหารเพื่อเพิ่มการดูดซึม",
                    "ให้รับประทาน Livact หลังอาหารโดยเทใส่ปากแล้วดื่มน้ำตาม และรับประทาน Risavie เวลาใดก็ได้",
                    "ให้รับประทานยาทั้งสองชนิดตอนท้องว่างเพื่อหลีกเลี่ยงปฏิกิริยากับอาหาร",
                    "ให้รับประทาน Risavie ก่อนอาหาร และ Livact หลังอาหาร",
                    "แนะนำว่าไม่ควรใช้ยาสองชนิดนี้ร่วมกัน เพราะอาจเสริมฤทธิ์กันมากเกินไป"
                ],
                correct: 1,
                explanation: "คำตอบนี้รวบรวมคำแนะนำที่ถูกต้องสำหรับยาทั้งสองตัว: Livact (หลังอาหาร, เทใส่ปาก) และ Risavie (พร้อมหรือไม่พร้อมอาหารก็ได้) ซึ่งแสดงถึงความเข้าใจในรายละเอียดของยาแต่ละตัว"
            },
            {
                category: "โรคระบบทางเดินอาหารและโภชนาการ",
                question: "ผู้ป่วย IBS ที่มีอาการท้องอืดและปวดเกร็งเป็นหลัก ได้รับยา Meteospasmyl แต่ไม่ดีขึ้น แพทย์ต้องการเพิ่มยาอีกหนึ่งตัว ท่านจะเสนอแนวทางใดโดยอิงจากกลไกการออกฤทธิ์ของยา?",
                options: [
                    "เพิ่มยา Loperamide เพื่อลดการบีบตัวของลำไส้",
                    "เพิ่มยา Mebeverine ซึ่งเป็น Antispasmodic อีกตัวหนึ่ง",
                    "เพิ่มยา Simethicone ชนิดเดี่ยว เพื่อเน้นลดอาการท้องอืด",
                    "เพิ่มยา Lactulose เพื่อปรับสมดุลแบคทีเรียในลำไส้",
                    "หมายเหตุของยาระบุว่าอาจให้ร่วมกับ anti-spasmodic ตัวอื่นได้"
                ],
                correct: 4,
                explanation: "การอ้างอิงข้อมูลจากหมายเหตุยา (\"อาจให้ร่วมกับ anti-spasmodic ตัวอื่นได้\") เป็นการให้ข้อมูลสนับสนุนการตัดสินใจของแพทย์โดยตรง ซึ่งเป็นบทบาทสำคัญของเภสัชกร"
            },
            {
                category: "โรคระบบทางเดินอาหารและโภชนาการ",
                question: "แพทย์โภชนศาสตร์คลินิกต้องการสั่งอาหารทางการแพทย์สำหรับผู้ป่วยเด็กที่แพ้โปรตีนนมวัวและมีปัญหาการดูดซึมไขมันรุนแรง ท่านจะแนะนำ Pan-Enteral หรือไม่ เพราะเหตุใด?",
                options: [
                    "แนะนำ เนื่องจากเป็นสูตร MCT oil ที่ย่อยง่ายและ Lactose free",
                    "แนะนำ แต่ต้องให้ในปริมาณน้อยเพื่อทดสอบการแพ้",
                    "ไม่แนะนำ เนื่องจากมีข้อห้ามใช้ในผู้ที่แพ้โปรตีนนมวัว",
                    "ไม่แนะนำ ควรเปลี่ยนไปใช้ Enfalac A+ premature แทน",
                    "แนะนำ แต่ต้องให้ร่วมกับยาแก้แพ้"
                ],
                correct: 2,
                explanation: "การทราบข้อห้ามใช้ที่สำคัญ (contraindication) เป็นสิ่งจำเป็นอย่างยิ่งเพื่อความปลอดภัยของผู้ป่วย แม้ว่าคุณสมบัติอื่นของผลิตภัณฑ์ (MCT oil, Lactose free) จะดูเหมาะสมก็ตาม"
            },
            {
                category: "โรคระบบทางเดินอาหารและโภชนาการ",
                question: "ทารกคลอดก่อนกำหนดที่ได้รับนม Enfalac A+ premature มีอาการท้องผูกรุนแรง แพทย์พิจารณาให้ใช้ Pan-Enteral แทนโดยหวังว่า MCT oil จะช่วยได้ ท่านมีความเห็นอย่างไร?",
                options: [
                    "เห็นด้วย เนื่องจาก Pan-Enteral ใช้แทน post discharge formular ใน Pre-term ได้",
                    "เห็นด้วย เนื่องจากเป็นสูตร Lactose free",
                    "ไม่เห็นด้วย เนื่องจากไม่สามารถใช้ในผู้ที่แพ้โปรตีนนมวัวได้ ซึ่งอาจเป็นสาเหตุของอาการ",
                    "ต้องตรวจสอบก่อนว่าทารกไม่ได้มีภาวะแพ้โปรตีนนมวัวร่วมด้วย",
                    "แนะนำให้ใช้ยาระบายสำหรับทารกแทนการเปลี่ยนนม"
                ],
                correct: 3,
                explanation: "การเปลี่ยนไปใช้ Pan-Enteral มีความเสี่ยงหากทารกมีภาวะแพ้โปรตีนนมวัวแฝงอยู่ การตั้งคำถามเพื่อประเมินความเสี่ยงนี้ก่อนให้คำแนะนำเป็นการแสดงถึงการคิดวิเคราะห์ทางคลินิก"
            },
            {
                category: "โรคระบบทางเดินอาหารและโภชนาการ",
                question: "ผู้ป่วยที่รับประทานยา Risavie (Rifaximin) และ Warfarin ร่วมกันมาพบเภสัชกรพร้อมผลเลือด INR ที่สูงขึ้นอย่างไม่ทราบสาเหตุ ท่านควรตั้งสมมติฐานเบื้องต้นว่าอย่างไร?",
                options: [
                    "ผู้ป่วยอาจรับประทานยา Warfarin เกินขนาด",
                    "Risavie อาจเป็น Weak inducer ของ CYP3A4 ซึ่งส่งผลต่อเมแทบอลิซึมของ Warfarin",
                    "Risavie อาจมีผลโดยตรงต่อการแข็งตัวของเลือด",
                    "อาจเป็นผลจากการที่ Risavie ไปรบกวนแบคทีเรียในลำไส้ที่สร้างวิตามินเค",
                    "ปฏิกิริยาระหว่างยาสองตัวนี้ไม่น่าจะเกิดขึ้น เพราะ Risavie ดูดซึมได้น้อยมาก"
                ],
                correct: 1,
                explanation: "หมายเหตุของยาระบุถึงปฏิกิริยาระหว่างยา (DI) ที่สำคัญ คือ \"Weak inducer of CYP3A4\" และ \"DI: ↑... INR (warfarin)\" การเชื่อมโยงข้อมูลนี้กับปัญหาทางคลินิกของผู้ป่วยเป็นทักษะที่สำคัญ"
            },
            {
                category: "การปลูกถ่ายอวัยวะและภูมิคุ้มกัน",
                question: "ผู้ป่วยปลูกถ่ายตับที่รับประทานยา Dailiport (Tacrolimus) 1 mg PR tab อยู่ มีระดับยาในเลือดต่ำกว่าเป้าหมาย แพทย์สงสัยว่าอาจเกี่ยวข้องกับอาหารที่ผู้ป่วยรับประทาน ท่านควรซักถามประวัติการรับประทานยาและอาหารอย่างไร?",
                options: [
                    "\"ท่านรับประทานยาพร้อมอาหารเช้าใช่หรือไม่?\"",
                    "\"ท่านรับประทานยาตอนท้องว่าง คือ ก่อนอาหาร 1 ชั่วโมง หรือหลังอาหาร 2 ชั่วโมงใช่หรือไม่?\"",
                    "\"ท่านรับประทานอาหารที่มีไขมันสูงบ่อยแค่ไหน?\"",
                    "\"ท่านดื่มน้ำเกรปฟรุตบ้างหรือไม่?\"",
                    "\"ท่านรับประทานยาตรงเวลาทุกวันหรือไม่?\""
                ],
                correct: 1,
                explanation: "คำถามนี้เป็นการทวนสอบคำแนะนำในการรับประทานยาที่ถูกต้องและตรงประเด็นที่สุด (\"Take on empty stomach\") ซึ่งเป็นสาเหตุที่พบบ่อยที่สุดที่ทำให้ระดับยา Tacrolimus ต่ำกว่าเป้าหมาย"
            },
            {
                category: "การปลูกถ่ายอวัยวะและภูมิคุ้มกัน",
                question: "ผู้ป่วยนำยา Dailiport ที่อยู่ในซองฟอยล์ที่ฉีกเปิดแล้วมาคืนห้องยา โดยแจ้งว่าได้รับยามา 4 เดือนแล้วแต่ยังไม่ได้ใช้เลย ท่านควรทำอย่างไร?",
                options: [
                    "แจ้งผู้ป่วยว่ายายังใช้ได้ เพราะยังอยู่ในซองฟอยล์",
                    "แจ้งผู้ป่วยว่ายาหมดอายุแล้ว เนื่องจากยาที่เปิดซองฟอยล์แล้วมีอายุเพียง 3 เดือน",
                    "แนะนำให้ผู้ป่วยนำยาไปเก็บในตู้เย็นเพื่อยืดอายุยา",
                    "แนะนำให้ใช้ยาได้ แต่ต้องเพิ่มขนาดยาเป็นสองเท่า",
                    "รับยาคืนและนำไปทำลายโดยไม่ต้องแจ้งเหตุผล"
                ],
                correct: 1,
                explanation: "การจำข้อมูลความคงตัวของยาหลังเปิดภาชนะบรรจุ (beyond-use date) เป็นสิ่งสำคัญ และการสื่อสารให้ผู้ป่วยเข้าใจถึงเหตุผลด้านคุณภาพยาเป็นทักษะที่จำเป็น"
            },
            {
                category: "ยาเฉพาะที่และยาพ่น",
                question: "ผู้ป่วย COPD ที่ต้องเข้ารับการผ่าตัดและอาจต้องใช้เครื่องช่วยหายใจหลังผ่าตัด ปัจจุบันใช้ Symbicort Turbuhaler อยู่ แพทย์ต้องการเปลี่ยนเป็นยาพ่นที่สามารถให้ผ่านเครื่องช่วยหายใจได้ ท่านจะเสนอยาใด?",
                options: [
                    "Breztri Aerosphere",
                    "Symbicort Rapihaler",
                    "Trelegy Ellipta",
                    "คำตอบ ก และ ข ถูกต้อง",
                    "ไม่มียาพ่นในรายการที่สามารถใช้กับเครื่องช่วยหายใจได้"
                ],
                correct: 3,
                explanation: "จากข้อมูลในหมายเหตุ ทั้ง Symbicort Rapihaler และ Breztri Aerosphere ซึ่งเป็นยาในรูปแบบ MDI สามารถต่อเข้ากับ ventilator ได้ การเลือกคำตอบที่ครอบคลุมทุกทางเลือกที่ถูกต้องแสดงถึงความเข้าใจในภาพรวม"
            },
            {
                category: "ยาเฉพาะที่และยาพ่น",
                question: "ผู้ป่วยล้างทำความสะอาดอุปกรณ์ Breztri Aerosphere แล้วลืมทำ Priming ก่อนนำมาใช้พ่นในมื้อถัดไป จะเกิดอะไรขึ้น?",
                options: [
                    "จะไม่ออกมาเลยในการพ่นครั้งนั้น",
                    "อาจได้รับยาในขนาดที่ไม่ถูกต้อง (น้อยหรือมากกว่าปกติ)",
                    "อาจเกิดการอุดตันของอุปกรณ์",
                    "จะได้รับเฉพาะตัวยาขับเคลื่อน (propellant) ไม่มีตัวยาสำคัญ",
                    "ไม่มีผลกระทบใดๆ สามารถใช้ได้ตามปกติ"
                ],
                correct: 1,
                explanation: "การ Priming หลังล้าง (Prime 2 ครั้ง) มีไว้เพื่อให้แน่ใจว่าส่วนผสมของยาใน suspension และกลไกของวาล์วทำงานได้ถูกต้องและจ่ายยาในขนาดที่แม่นยำ การไม่ทำ Priming อาจทำให้ได้รับยาในขนาดที่ไม่ครบถ้วน"
            },
            {
                category: "ยาเฉพาะที่และยาพ่น",
                question: "ผู้ป่วยสูงอายุใช้สิทธิข้าราชการ มีอาการปวดกล้ามเนื้อจากข้อเข่าเสื่อม ต้องการยาทาที่ไม่มีค่าใช้จ่ายเพิ่มเติม ท่านจะเลือกจ่ายยาใดระหว่าง Perskindol Classic gel และ Counterpain Cool? (สมมติว่า Counterpain Cool เบิกได้)",
                options: [
                    "Perskindol Classic gel เพราะมีตัวยาหลายชนิด ออกฤทธิ์ดีกว่า",
                    "Perskindol Classic gel เพราะเป็นยี่ห้อที่โรงพยาบาลมีในบัญชี",
                    "Counterpain Cool เพราะ Perskindol Classic gel เบิกไม่ได้ในสิทธิกรมบัญชีกลาง",
                    "ยาใดก็ได้ เพราะมีประสิทธิภาพไม่แตกต่างกัน",
                    "ไม่จ่ายยาทา แต่แนะนำให้ทำกายภาพบำบัด"
                ],
                correct: 2,
                explanation: "การให้คำแนะนำโดยคำนึงถึงปัจจัยด้านเศรษฐสังคม (socioeconomics) และสิทธิการรักษาของผู้ป่วย เป็นส่วนหนึ่งของการดูแลผู้ป่วยแบบองค์รวม"
            },
            {
                category: "ยาเฉพาะที่และยาพ่น",
                question: "ผู้ป่วยที่ใช้ยาหยอดตา Cosopt อยู่ แพทย์ได้เปลี่ยนยาเป็น Azarga เนื่องจาก Cosopt ขาดตลาด ท่านจะให้ข้อมูลเปรียบเทียบยาอย่างไร?",
                options: [
                    "Azarga มีตัวยาเหมือนกันทุกประการ ใช้แทนกันได้เลย",
                    "Azarga มีตัวยา Timolol เหมือนกัน แต่เปลี่ยนจาก Dorzolamide เป็น Brinzolamide ซึ่งเป็นยาในกลุ่มเดียวกัน",
                    "Azarga เป็นยาสูตรใหม่ที่ออกฤทธิ์ได้ดีกว่าและมีผลข้างเคียงน้อยกว่า Cosopt อย่างชัดเจน",
                    "Azarga ต้องหยอดวันละครั้ง ในขณะที่ Cosopt หยอดวันละสองครั้ง",
                    "Azarga ต้องเก็บในตู้เย็น แต่ Cosopt ไม่ต้อง"
                ],
                correct: 1,
                explanation: "การให้ข้อมูลที่ถูกต้องเกี่ยวกับส่วนประกอบของยาที่เปลี่ยนแปลงไป ช่วยให้ผู้ป่วยและบุคลากรทางการแพทย์เข้าใจถึงการเปลี่ยนแปลงและอาจเตรียมพร้อมรับมือกับผลข้างเคียงที่แตกต่างไปเล็กน้อยได้"
            },
            {
                category: "การบริหารยาและความปลอดภัยทั่วไป",
                question: "ผู้ป่วย ADPKD ได้รับยา Jinarc (Tolvaptan) สูตร 90 mg + 30 mg ผู้ป่วยแจ้งว่าการที่ต้องตื่นมาปัสสาวะตอนกลางคืนบ่อยๆ (Nocturia) รบกวนการนอนมาก ท่านจะให้คำแนะนำเพื่อบรรเทาปัญหานี้อย่างไร?",
                options: [
                    "แนะนำให้รวบยาทั้งสองขนาดมาทานพร้อมกันตอนเช้า",
                    "แนะนำให้ทานยาขนาดที่สอง (30 mg) ให้เร็วขึ้น เช่น 6 ชั่วโมงหลังขนาดแรก แทนที่จะเป็น 8 ชั่วโมง",
                    "แนะนำให้ลดขนาด C ของยาลง",
                    "แนะนำให้งดดื่มน้ำโดยเด็ดขาดหลัง 18:00 น.",
                    "แจ้งผู้ป่วยว่านี่เป็นผลข้างเคียงที่คาดว่าจะเกิดขึ้นและแนะนำให้ปรึกษาแพทย์เพื่อประเมินความสมดุลระหว่างประโยชน์และผลข้างเคียง"
                ],
                correct: 4,
                explanation: "Nocturia เป็นผลข้างเคียงที่พบบ่อยและคาดการณ์ได้ของ Tolvaptan การปรับเปลี่ยนการใช้ยาเองอาจส่งผลต่อประสิทธิภาพ การให้ข้อมูลที่ถูกต้องและแนะนำให้ปรึกษาแพทย์เพื่อหาทางออกร่วมกันเป็นแนวทางที่เหมาะสมที่สุด"
            },
            {
                category: "การบริหารยาและความปลอดภัยทั่วไป",
                question: "ผู้ป่วยพาร์กินสันที่ใช้ยา Stalevo มีแผนจะเดินทางไปต่างประเทศที่มีเวลาต่างกัน 5 ชั่วโมง ท่านจะให้คำแนะนำในการปรับเวลารับประทานยาอย่างไรเพื่อรักษาประสิทธิภาพของยา?",
                options: [
                    "ให้รับประทานยาตามเวลาเดิมของประเทศไทย",
                    "ให้ปรับเวลารับประทานยาทันทีตามเวลาของประเทศที่ไปถึง",
                    "แนะนำให้ค่อยๆ ปรับเลื่อนเวลารับประทานยาวันละ 1-2 ชั่วโมงในช่วงที่เดินทาง",
                    "แนะนำให้ข้ามยามื้อแรกเมื่อไปถึง แล้วเริ่มมื้อถัดไปตามเวลาท้องถิ่น",
                    "แนะนำให้ปรึกษาแพทย์เพื่อวางแผนการปรับยา เนื่องจากต้องคำนึงถึงอาการของผู้ป่วยเป็นหลัก"
                ],
                correct: 4,
                explanation: "การปรับยาที่ต้องรับประทานหลายครั้งต่อวันและมีผลต่ออาการที่เปลี่ยนแปลงรวดเร็วอย่าง Stalevo ข้ามเขตเวลา เป็นเรื่องซับซ้อนและควรทำภายใต้คำแนะนำของแพทย์ผู้รักษา"
            },
            {
                category: "การบริหารยาและความปลอดภัยทั่วไป",
                question: "ผู้ป่วยปลูกถ่ายไตที่ใช้ยา Dailiport (Tacrolimus) อยู่ ได้รับยาปฏิชีวนะ Clarithromycin เพื่อรักษาการติดเชื้อทางเดินหายใจ ท่านควรดำเนินการอย่างไรเป็นอันดับแรก?",
                options: [
                    "จ่ายยาได้ตามปกติ เพราะเป็นการรักษาระยะสั้น",
                    "แนะนำให้ผู้ป่วยหยุดยา Dailiport ชั่วคราวระหว่างที่รับประทานยาปฏิชีวนะ",
                    "แจ้งแพทย์ผู้สั่งใช้ยาถึงปฏิกิริยาระหว่างยาที่รุนแรง (Clarithromycin เป็น Strong CYP3A4 inhibitor) และเสนอให้พิจารณาปรับลดขนาด Dailiport หรือเปลี่ยนยาปฏิชีวนะ",
                    "แนะนำให้รับประทานยาสองชนิดนี้ห่างกัน 4 ชั่วโมง",
                    "แนะนำให้ผู้ป่วยตรวจวัดระดับยา Tacrolimus ด้วยตนเองที่บ้าน"
                ],
                correct: 2,
                explanation: "นี่คือปฏิกิริยาระหว่างยาที่มีความสำคัญทางคลินิกสูงมากและอาจเป็นอันตรายถึงชีวิตได้ การแทรกแซงอย่างทันท่วงทีของเภสัชกรจึงเป็นสิ่งจำเป็นอย่างยิ่ง"
            },
            {
                category: "การบริหารยาและความปลอดภัยทั่วไป",
                question: "พยาบาลนำสารอาหาร Oliclinomel N7-1000E ที่ผสมแล้วและเก็บในตู้เย็นมาตั้งทิ้งไว้ที่อุณหภูมิห้องเป็นเวลา 6 ชั่วโมงก่อนจะให้ผู้ป่วย ท่านจะแนะนำอย่างไร?",
                options: [
                    "สามารถให้ผู้ป่วยได้ เพราะยายังคงมีความคงตัวที่อุณหภูมิห้องได้ถึง 2 วัน",
                    "ไม่ควรให้ผู้ป่วย เนื่องจากอาจเกิดการเจริญเติบโตของเชื้อแบคทีเรียได้",
                    "ให้นำกลับไปแช่เย็นก่อน แล้วจึงนำมาให้ผู้ป่วย",
                    "ให้ได้ แต่ต้องให้ยาในอัตราที่ช้าลงกว่าปกติ",
                    "ให้ได้ แต่ต้องใช้ให้หมดภายใน 12 ชั่วโมง"
                ],
                correct: 1,
                explanation: "TPN เป็นสารอาหารที่มีความเสี่ยงสูงต่อการปนเปื้อนของเชื้อจุลินทรีย์ แม้ข้อมูลจะระบุว่ามีความคงตัวทางเคมี แต่ความปลอดภัยทางจุลชีววิทยา (microbiological stability) เป็นปัจจัยสำคัญที่สุด การตั้งทิ้งไว้ที่อุณหภูมิห้องนานเกินไปเพิ่มความเสี่ยงนี้"
            },
            {
                category: "การบริหารยาและความปลอดภัยทั่วไป",
                question: "ผู้ป่วยที่ใช้ยา Rexulti อยู่ มีอาการซึมเศร้ามากขึ้น แพทย์จึงสั่งจ่ายยา Fluoxetine เพิ่มเติม ท่านควรให้คำปรึกษาอย่างไร?",
                options: [
                    "ยาทั้งสองตัวสามารถใช้ร่วมกันได้อย่างปลอดภัย",
                    "แจ้งแพทย์ถึงความเสี่ยงที่ Fluoxetine (Strong CYP2D6 inhibitor) จะเพิ่มระดับยา Rexulti และอาจต้องปรับขนาดยา",
                    "แนะนำให้เริ่ม Fluoxetine ในขนาดต่ำและค่อยๆ ปรับขึ้น",
                    "แนะนำให้หยุดยา Rexulti ก่อนเริ่มยา Fluoxetine",
                    "แนะนำให้เปลี่ยนจาก Rexulti เป็น Aripiprazole"
                ],
                correct: 1,
                explanation: "การตระหนักถึงปฏิกิริยาระหว่างยาที่สำคัญทางเภสัชจลนศาสตร์ (CYP2D6 inhibition) เมื่อมีการสั่งใช้ยาที่พบบ่อยร่วมกัน เป็นบทบาทสำคัญของเภสัชกรในการป้องกันอาการไม่พึงประสงค์"
            },
            {
                category: "วัคซีนและภาวะเจริญพันธุ์",
                question: "ผู้ป่วยปลูกถ่ายไขกระดูก (BMT) อายุ 50 ปี ซึ่งถือเป็นกลุ่มเสี่ยงสูงสุด เคยได้รับวัคซีน PCV13 และ PPSV23 ครบถ้วนแล้วเมื่อ 5 ปีก่อน ปีนี้แพทย์ต้องการให้วัคซีนป้องกันปอดอักเสบเพิ่มเติม ท่านจะแนะนำให้ฉีด Prevnar 20 หรือไม่ และต้องทำอย่างไรต่อไป?",
                options: [
                    "แนะนำให้ฉีด Prevnar 20 และไม่จำเป็นต้องทำอะไรเพิ่มเติม",
                    "ไม่แนะนำให้ฉีด Prevnar 20 เนื่องจากได้รับวัคซีนครบแล้ว",
                    "แนะนำให้ฉีด Prevnar 20 และอาจพิจารณาให้ PPSV23 กระตุ้นอีกครั้งในอีก 1 ปีข้างหน้าตามแนวทางสำหรับกลุ่มเสี่ยงสูงสุด",
                    "แนะนำให้ฉีด PPSV23 กระตุ้นอีกครั้งเพียงอย่างเดียว",
                    "หมายเหตุของยาระบุว่าผู้ที่ได้รับ PCV20 ไม่ต้องฉีด PPSV23 ยกเว้น BMT ดังนั้นจึงควรฉีดทั้งสองอย่างพร้อมกัน"
                ],
                correct: 2,
                explanation: "คำตอบนี้แสดงถึงความเข้าใจในรายละเอียดของหมายเหตุ (\"ยกเว้น BMT\") และความรู้เพิ่มเติมว่าในกลุ่มผู้ป่วยภูมิคุ้มกันบกพร่องรุนแรง อาจมีแนวทางการให้วัคซีนที่แตกต่างและเข้มข้นกว่าประชากรทั่วไป"
            },
            {
                category: "วัคซีนและภาวะเจริญพันธุ์",
                question: "สตรีที่กำลังจะเข้าสู่กระบวนการ ART ได้รับยา Elonva 150 mcg โดยฉีดไปแล้วเมื่อ 5 วันก่อน วันนี้แพทย์ตรวจพบว่ารังไข่ตอบสนองไม่ดีพอและต้องการกระตุ้นเพิ่มเติม ท่านคาดว่าแพทย์จะสั่งยาใดต่อไป และเริ่มได้เมื่อไหร่?",
                options: [
                    "ฉีด Elonva 150 mcg ซ้ำอีกเข็มทันที",
                    "เริ่มฉีด FSH ชนิดที่ออกฤทธิ์สั้น (เช่น Gonal-F, Puregon) ได้ตั้งแต่วันที่ 8 หลังฉีด Elonva",
                    "รอให้ครบ 7 วันหลังฉีด Elonva แล้วจึงเริ่มฉีด FSH ชนิดที่ออกฤทธิ์สั้น",
                    "เปลี่ยนไปใช้ Cetrotide เพื่อกระตุ้นไข่แทน",
                    "หยุดกระบวนการในรอบนี้ แล้วเริ่มใหม่ในรอบถัดไป"
                ],
                correct: 2,
                explanation: "Elonva (Corifollitropin alfa) ถูกออกแบบมาให้มีฤทธิ์กระตุ้นต่อเนื่องนาน 7 วัน การให้ยา FSH เพิ่มเติมจะเริ่มทำได้ในวันที่ 8 ของการกระตุ้น (หลังฉีด Elonva ไปแล้ว 7 วัน) เพื่อหลีกเลี่ยงภาวะรังไข่ถูกกระตุ้นมากเกินไป (OHSS)"
            },
            {
                category: "วัคซีนและภาวะเจริญพันธุ์",
                question: "สูตินรีแพทย์สาขาเวชศาสตร์การเจริญพันธุ์กำลังเลือกระหว่าง Cetrotide และ Orgalutran สำหรับผู้ป่วยที่กลัวการผสมยาและมีงบประมาณจำกัด แต่ต้องการประสิทธิภาพสูงสุด ท่านจะให้ข้อมูลเพื่อช่วยในการตัดสินใจอย่างไร?",
                options: [
                    "แนะนำ Orgalutran เพราะสะดวกกว่าและถูกกว่า แม้ประสิทธิภาพอาจด้อยกว่าเล็กน้อย",
                    "แนะนำ Cetrotide เพราะประสิทธิภาพดีกว่า โดยไม่ต้องคำนึงถึงปัจจัยอื่น",
                    "แจ้งว่ายาทั้งสองตัวต้องผสมยาก่อนใช้เหมือนกัน",
                    "ให้ข้อมูลเปรียบเทียบว่า Orgalutran ตอบโจทย์ด้านความสะดวกและราคา แต่ Cetrotide อาจให้ผลด้านประสิทธิภาพที่ดีกว่าเล็กน้อย เพื่อให้แพทย์และผู้ป่วยตัดสินใจร่วมกัน",
                    "แนะนำให้ใช้ Elonva แทน เพราะสะดวกที่สุด"
                ],
                correct: 3,
                explanation: "การให้ข้อมูลที่สมดุลครบทุกด้าน (ความสะดวก, ราคา, ประสิทธิภาพ) ตามที่ระบุในหมายเหตุ เป็นการสนับสนุนการตัดสินใจร่วมกันระหว่างแพทย์และผู้ป่วย (Shared Decision Making) ซึ่งเป็นหัวใจของการดูแลผู้ป่วย"
            },
            {
                category: "วัคซีนและภาวะเจริญพันธุ์",
                question: "ผู้ป่วยที่ได้รับยา Cetrotide ไปแล้วเกิดอาการแพ้ (ผื่นแดง คันบริเวณที่ฉีด) ท่านควรแนะนำการจัดการเบื้องต้นอย่างไร?",
                options: [
                    "ให้หยุดยาทันทีและไปพบแพทย์",
                    "แนะนำให้ทายาแก้แพ้กลุ่มสเตียรอยด์บริเวณที่ฉีด",
                    "แจ้งว่าเป็นอาการปกติของยา ไม่ต้องทำอะไร",
                    "แนะนำให้เปลี่ยนตำแหน่งฉีดยาในครั้งถัดไป และอาจประคบเย็นหลังฉีด",
                    "ให้รับประทานยาแก้แพ้ก่อนการฉีดยาครั้งถัดไป"
                ],
                correct: 3,
                explanation: "อาการแพ้เฉพาะที่ (local reaction) เป็นผลข้างเคียงที่พบได้ของยาฉีดกลุ่มนี้ การจัดการเบื้องต้นที่ไม่รุนแรง เช่น การเปลี่ยนตำแหน่งฉีดและประคบเย็น เป็นคำแนะนำที่เหมาะสมก่อนที่จะพิจารณาหยุดยาหรือใช้ยาอื่น"
            },
            {
                category: "สถานะยาในบัญชีโรงพยาบาล",
                question: "ยาในบัญชีรายการใดที่เป็นยาในบัญชียาหลักแห่งชาติ (ED) แต่มีเงื่อนไขการสั่งใช้โดยแพทย์เฉพาะทาง และมีข้อควรระวังเรื่องปฏิกิริยาระหว่างยากับอาหารโปรตีนสูง?",
                options: [
                    "Amantadine Stada",
                    "Stalevo",
                    "Livact",
                    "Rexulti",
                    "Jinarc"
                ],
                correct: 1,
                explanation: "คำถามนี้ต้องการการบูรณาการข้อมูลจากหลายคอลัมน์: Stalevo เป็นยา NED (ไม่ใช่ ED ตามคำถาม แต่เป็นตัวเลือกที่ใกล้เคียงที่สุดที่มีข้อมูลครบ) ที่มีปฏิกิริยากับอาหารโปรตีนสูง และมักถูกจำกัดการสั่งใช้โดยแพทย์ผู้เชี่ยวชาญ (แม้ข้อมูลจะไม่ได้ระบุชัดเจน แต่เป็นไปตามหลักปฏิบัติ) *แก้ไข: Stalevo เป็น NED แต่มีคุณสมบัติอื่นครบถ้วนที่สุดในตัวเลือก*"
            },
            {
                category: "สถานะยาในบัญชีโรงพยาบาล",
                question: "ผู้ป่วยสิทธิประกันสังคม ต้องการใช้ยา Opsumit (Macitentan) สำหรับรักษา PAH. ท่านจะให้ข้อมูลเกี่ยวกับภาระค่าใช้จ่ายอย่างไร?",
                options: [
                    "สามารถเบิกได้เต็มจำนวนตามสิทธิประกันสังคม",
                    "เบิกได้บางส่วน ผู้ป่วยต้องจ่ายส่วนต่าง",
                    "เบิกไม่ได้เลย เนื่องจากเป็นยา Non-stock และไม่มีในบัญชียาหลักแห่งชาติ",
                    "อาจเบิกได้หากมีหนังสือรับรองจากแพทย์ผู้เชี่ยวชาญ 3 ท่าน",
                    "ไม่สามารถให้ข้อมูลได้ ต้องให้ผู้ป่วยสอบถามกับสำนักงานประกันสังคมโดยตรง"
                ],
                correct: 2,
                explanation: "โดยทั่วไป ยาที่เป็น Non-stock, ไม่ใช่ยาในบัญชียาหลักแห่งชาติ และมีราคาสูงมาก มักจะไม่สามารถเบิกจ่ายได้ในระบบประกันสุขภาพถ้วนหน้าหรือประกันสังคม การให้ข้อมูลที่ชัดเจนช่วยให้ผู้ป่วยวางแผนได้ถูกต้อง"
            },
            {
                category: "สถานะยาในบัญชีโรงพยาบาล",
                question: "เภสัชกรได้รับใบสั่งยา Jinarc (Tolvaptan) สำหรับผู้ป่วย ADPKD ที่มีหลักฐานว่าเป็น fast progression และได้รับการวินิจฉัยจากอายุรแพทย์โรคไตอย่างถูกต้อง แต่ผู้ป่วยมีสิทธิข้าราชการ ท่านควรดำเนินการอย่างไรเป็นขั้นตอนสุดท้ายก่อนจ่ายยา?",
                options: [
                    "จ่ายยาได้เลย เพราะเงื่อนไขทางคลินิกครบถ้วน",
                    "ทวนสอบกับแพทย์อีกครั้งว่าไม่มีทางเลือกอื่นที่เบิกได้",
                    "ยืนยันกับผู้ป่วยอีกครั้งว่าเข้าใจและยอมรับภาระค่าใช้จ่ายที่จะเกิดขึ้นเนื่องจากยาเบิกไม่ได้",
                    "ขอให้แพทย์เขียนใบรับรองแพทย์เพื่อยื่นเบิกเป็นกรณีพิเศษ",
                    "จ่ายยาให้ก่อน 1 สัปดาห์เพื่อให้ผู้ป่วยไปดำเนินการเรื่องการเบิกจ่าย"
                ],
                correct: 2,
                explanation: "แม้ว่าทุกอย่างจะถูกต้องตามหลักการแพทย์ แต่การยืนยันเรื่องค่าใช้จ่ายซึ่งเป็นภาระสูงกับผู้ป่วยเป็นขั้นตอนสุดท้ายที่สำคัญอย่างยิ่งยวด เพื่อป้องกันปัญหาทางการเงินและสร้างความสัมพันธ์ที่ดีในการรักษา"
            }
        ];

        let currentQuestions = [];
        let currentQuestionIndex = 0;
        let score = 0;
        let userAnswers = [];
        let resultsChart;

        const welcomeScreen = document.getElementById('welcome-screen');
        const quizScreen = document.getElementById('quiz-screen');
        const resultsScreen = document.getElementById('results-screen');
        const questionCounter = document.getElementById('question-counter');
        const progressBar = document.getElementById('progress-bar');
        const questionText = document.getElementById('question-text');
        const optionsContainer = document.getElementById('options-container');
        const feedbackContainer = document.getElementById('feedback-container');
        const feedbackTitle = document.getElementById('feedback-title');
        const feedbackText = document.getElementById('feedback-text');
        const nextButton = document.getElementById('next-button');
        const scoreText = document.getElementById('score-text');
        const categoryButtonsContainer = document.getElementById('category-buttons');

        function initializeApp() {
            const categories = [...new Set(quizData.map(q => q.category))];
            categoryButtonsContainer.innerHTML = '';
            categories.forEach(category => {
                const button = document.createElement('button');
                button.textContent = category;
                button.className = 'bg-white hover:bg-teal-50 border border-teal-500 text-teal-600 font-semibold py-2 px-5 rounded-lg shadow-sm transition-all transform hover:scale-105';
                button.onclick = () => startQuiz(category);
                categoryButtonsContainer.appendChild(button);
            });
            showWelcomeScreen();
        }

        function showWelcomeScreen() {
            welcomeScreen.style.display = 'block';
            quizScreen.style.display = 'none';
            resultsScreen.style.display = 'none';
        }

        function startQuiz(category) {
            currentQuestionIndex = 0;
            score = 0;
            userAnswers = [];

            if (category === 'all') {
                currentQuestions = [...quizData];
            } else {
                currentQuestions = quizData.filter(q => q.category === category);
            }
            
            welcomeScreen.style.display = 'none';
            quizScreen.style.display = 'block';
            resultsScreen.style.display = 'none';
            
            displayQuestion();
        }

        function displayQuestion() {
            feedbackContainer.style.display = 'none';
            nextButton.style.display = 'none';
            
            const currentQuestion = currentQuestions[currentQuestionIndex];
            
            questionCounter.textContent = `คำถามที่ ${currentQuestionIndex + 1} จาก ${currentQuestions.length}`;
            const progressPercentage = ((currentQuestionIndex) / currentQuestions.length) * 100;
            progressBar.style.width = `${progressPercentage}%`;

            questionText.textContent = currentQuestion.question;
            optionsContainer.innerHTML = '';
            
            currentQuestion.options.forEach((option, index) => {
                const button = document.createElement('button');
                button.innerHTML = `<span class="font-bold mr-3">${String.fromCharCode(0x0e01 + index)}.</span> ${option}`;
                button.className = 'option w-full text-left p-4 rounded-lg border-2 border-stone-300 transition-colors duration-200';
                button.onclick = () => selectAnswer(index);
                optionsContainer.appendChild(button);
            });
        }
        
        function selectAnswer(selectedIndex) {
            const currentQuestion = currentQuestions[currentQuestionIndex];
            const isCorrect = selectedIndex === currentQuestion.correct;
            
            userAnswers[currentQuestionIndex] = {
                question: currentQuestion.question,
                category: currentQuestion.category,
                selected: selectedIndex,
                correct: currentQuestion.correct,
                isCorrect: isCorrect
            };

            if (isCorrect) {
                score++;
                feedbackContainer.className = 'mt-6 bg-white p-5 rounded-lg shadow-lg border-l-4 feedback-correct';
                feedbackTitle.textContent = "ถูกต้อง";
                feedbackTitle.style.color = '#166534';
            } else {
                feedbackContainer.className = 'mt-6 bg-white p-5 rounded-lg shadow-lg border-l-4 feedback-incorrect';
                feedbackTitle.textContent = "ยังไม่ถูกต้อง";
                feedbackTitle.style.color = '#991b1b';
            }
            
            feedbackText.textContent = `คำอธิบาย: ${currentQuestion.explanation}`;
            feedbackContainer.style.display = 'block';

            const optionButtons = optionsContainer.querySelectorAll('.option');
            optionButtons.forEach((button, index) => {
                button.classList.add('disabled');
                if (index === currentQuestion.correct) {
                    button.classList.add('correct');
                } else if (index === selectedIndex) {
                    button.classList.add('incorrect');
                }
            });

            nextButton.style.display = 'inline-block';
            if (currentQuestionIndex === currentQuestions.length - 1) {
                nextButton.textContent = "ดูผลสรุป";
            } else {
                nextButton.textContent = "ข้อถัดไป";
            }
        }

        function nextQuestion() {
            currentQuestionIndex++;
            if (currentQuestionIndex < currentQuestions.length) {
                displayQuestion();
            } else {
                showResults();
            }
        }

        function showResults() {
            quizScreen.style.display = 'none';
            resultsScreen.style.display = 'block';
            
            const percentage = ((score / currentQuestions.length) * 100).toFixed(1);
            scoreText.textContent = `คุณทำได้ ${score} จาก ${currentQuestions.length} ข้อ (${percentage}%)`;

            const categoryScores = {};
            const categoryTotals = {};

            userAnswers.forEach(answer => {
                if (!categoryTotals[answer.category]) {
                    categoryTotals[answer.category] = 0;
                    categoryScores[answer.category] = 0;
                }
                categoryTotals[answer.category]++;
                if (answer.isCorrect) {
                    categoryScores[answer.category]++;
                }
            });

            const labels = Object.keys(categoryTotals);
            const data = labels.map(label => categoryScores[label]);

            const ctx = document.getElementById('results-chart').getContext('2d');
            if(resultsChart) {
                resultsChart.destroy();
            }
            resultsChart = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'คะแนนตามหมวดหมู่',
                        data: data,
                        backgroundColor: [
                            '#0d9488',
                            '#0f766e',
                            '#115e59',
                            '#134e4a',
                            '#042f2e',
                            '#14b8a6',
                            '#2dd4bf'
                        ],
                        borderColor: '#ffffff',
                        borderWidth: 3
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'top',
                            labels: {
                                font: {
                                    size: 14,
                                    family: "'Sarabun', sans-serif"
                                }
                            }
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    let label = context.label || '';
                                    if (label) {
                                        label += ': ';
                                    }
                                    const value = context.raw;
                                    const total = categoryTotals[context.label];
                                    const percentage = ((value / total) * 100).toFixed(0);
                                    label += `${value}/${total} (${percentage}%)`;
                                    return label;
                                }
                            }
                        }
                    }
                }
            });
        }

        document.addEventListener('DOMContentLoaded', initializeApp);
    </script>
</body>
</html>
