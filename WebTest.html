<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°‡πÅ‡∏à‡πâ‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏¢‡∏≤ (Non-stock) ‚Äî No-GCP</title>

  <!-- Vendor CSS -->
  <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet" />
  <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
  <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@200;300;400;600;700&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css" />

  <!-- Vendor JS -->
  <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>

  <style>
    :root { --brand-1:#002f87; --brand-2:#1f3d7d; --accent:#f36b21; --accent-hover:#fcb58d; --bg:#f6f8fc; --text:#1c2333; --muted:#637087; --card-bg:#ffffffee; }
    body{font-family:'Sarabun',system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;color:var(--text);background:linear-gradient(160deg,#0f1d47 0%,#1f3d7d 50%,#0f1d47 100%) fixed;min-height:100vh;display:flex;flex-direction:column}
    .app-header{position:sticky;top:0;z-index:10;backdrop-filter:saturate(180%) blur(12px);background:rgba(255,255,255,.08);border-bottom:1px solid rgba(255,255,255,.12)}
    .app-header .inner{display:flex;align-items:center;gap:14px;padding:14px 18px;color:#fff}
    #logo{height:48px;width:auto}
    .brand-title{font-weight:700;font-size:1.125rem;letter-spacing:.3px}
    .brand-subtitle{font-size:.85rem;opacity:.9}
    .page-wrap{flex:1 1 auto;display:grid;place-items:start center;padding:28px 14px}
    .card-app{width:min(980px,100%);background:var(--card-bg);border-radius:18px;border:1px solid rgba(15,29,71,.08);box-shadow:0 12px 30px rgba(0,0,0,.12);overflow:hidden}
    .card-header{background:linear-gradient(135deg,#fff 0%,#eef3ff 100%);border-bottom:1px solid rgba(0,0,0,.06);padding:20px 22px}
    .card-header h1{color:var(--brand-1);font-size:1.4rem;font-weight:700;margin:0}
    .card-header .helper{color:#d93025;font-size:.9rem;font-weight:700;margin-top:6px}
    .card-body{padding:20px 22px 8px}
    .section-title{color:var(--brand-2);font-weight:700;font-size:1.05rem;margin-bottom:12px}
    label{font-weight:700;color:var(--text)}
    .form-control,.select2-container .select2-selection--single{border-radius:12px!important;border:1px solid #d8dce6!important;min-height:44px;font-size:1rem}
    .form-control:focus{border-color:var(--brand-1);box-shadow:0 0 0 .2rem rgba(0,47,135,.12)}
    .select2-container--default .select2-selection--single .select2-selection__rendered{font-weight:600;font-size:1rem;color:var(--text)}
    .select2-container--default .select2-results__option{font-weight:600;font-size:1rem}
    .select2-container--default .select2-selection--single .select2-selection__arrow{height:44px}
    .text-muted{color:var(--muted)!important}
    .btn-primary,#btn{background-color:var(--accent)!important;border-color:var(--accent)!important;color:#fff;font-weight:700;border-radius:12px;padding:10px 18px;box-shadow:0 6px 16px rgba(243,107,33,.3);transition:transform .06s ease,box-shadow .2s ease,background-color .2s ease}
    .btn-primary:hover,#btn:hover{background-color:var(--accent-hover)!important;transform:translateY(-1px);box-shadow:0 10px 18px rgba(243,107,33,.25)}
    .btn-primary:active,#btn:active{transform:translateY(0)}
    .help-row{display:flex;align-items:center;gap:10px;color:var(--muted);font-size:.95rem;margin-top:6px;margin-bottom:2px}
    #minDateDisplay{display:inline-block;margin-top:8px;padding:8px 12px;border-radius:999px;background:#fff5f5;color:#d93025;font-weight:700;border:1px solid #ffd9d6}
    footer{color:#fff;text-align:center;padding:12px 10px 20px}
    .footer-note{font-size:12px;opacity:.9}
    @media (max-width:576px){.card-body,.card-header{padding:16px}.app-header .inner{padding:10px 14px}#logo{height:40px}}
    .is-invalid{border-color:#dc3545!important}.invalid-feedback{display:block}
  </style>
</head>

<body>
  <header class="app-header">
    <div class="inner container">
      <img id="logo" src="https://raw.githubusercontent.com/Drugpurchasing/Drug-master/main/CRAlogo.png" alt="CRA Logo" />
      <div>
        <div class="brand-title">‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°‡πÅ‡∏à‡πâ‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏¢‡∏≤‡πÑ‡∏°‡πà‡∏™‡∏≥‡∏£‡∏≠‡∏á‡∏Ñ‡∏á‡∏Ñ‡∏•‡∏±‡∏á (Non-stock)</div>
        <div class="brand-subtitle">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏™‡πà‡∏á‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏Å‡πà‡∏≠‡∏ô‡πÉ‡∏ä‡πâ‡∏¢‡∏≤‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 14 ‡∏ß‡∏±‡∏ô‡∏ó‡∏≥‡∏Å‡∏≤‡∏£</div>
      </div>
      <div class="ml-auto d-none d-md-block text-right">
        <a href="https://drugpurchasing.github.io/Drug-master/NS-list.html" class="btn btn-sm btn-light font-weight-bold">‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</a>
      </div>
    </div>
  </header>

  <main class="page-wrap">
    <div class="card-app">
      <div class="card-header">
        <h1 id="title">‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°‡πÅ‡∏à‡πâ‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏¢‡∏≤‡πÑ‡∏°‡πà‡∏™‡∏≥‡∏£‡∏≠‡∏á‡∏Ñ‡∏á‡∏Ñ‡∏•‡∏±‡∏á (Non-stock)</h1>
        <div id="subtitle" class="helper">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏™‡πà‡∏á‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏Å‡πà‡∏≠‡∏ô‡πÉ‡∏ä‡πâ‡∏¢‡∏≤‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 14 ‡∏ß‡∏±‡∏ô‡∏ó‡∏≥‡∏Å‡∏≤‡∏£</div>
      </div>

      <div class="card-body">
        <form id="myForm" onsubmit="submitForm(); return false;" novalidate>
          <div class="section-title">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡∏™‡∏±‡πà‡∏á‡πÉ‡∏ä‡πâ‡∏¢‡∏≤</div>
          <div class="form-row">
            <div class="form-group col-md-6">
              <label for="doctorName">‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏• ‡πÅ‡∏û‡∏ó‡∏¢‡πå‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏¢‡∏≤</label>
              <input type="text" class="form-control" id="doctorName" name="doctorName" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏ô‡∏û. ‡∏Å‡πâ‡∏≠‡∏á‡∏†‡∏û ‡πÉ‡∏à‡∏î‡∏µ" required />
              <div class="invalid-feedback">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡πÅ‡∏û‡∏ó‡∏¢‡πå‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏¢‡∏≤</div>
            </div>
            <div class="form-group col-md-6">
              <label for="patientHN">HN ‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢</label>
              <input type="text" class="form-control" id="patientHN" name="patientHN" inputmode="numeric" pattern="^[0-9]+$" placeholder="‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô" required />
              <div class="invalid-feedback">HN ‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç</div>
            </div>
          </div>

          <div class="form-row">
            <div class="form-group col-md-6">
              <label for="patientName">‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏• ‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢</label>
              <input type="text" class="form-control" id="patientName" name="patientName" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß ‡∏™‡∏∏‡∏ä‡∏≤‡∏î‡∏≤ ‡πÉ‡∏à‡∏î‡∏µ" required />
              <div class="invalid-feedback">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢</div>
            </div>
            <div class="form-group col-md-6">
              <label for="dateNeeded">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏¢‡∏≤</label>
              <small class="form-text text-muted">‡∏¢‡∏≤‡∏à‡∏∞‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏´‡∏•‡∏±‡∏á 14 ‡∏ß‡∏±‡∏ô‡∏ó‡∏≥‡∏Å‡∏≤‡∏£</small>
              <div class="input-group">
                <input type="text" class="form-control" id="dateNeeded" name="dateNeeded" readonly required aria-describedby="minDateHelp" />
                <div class="input-group-append"><span class="input-group-text">üìÖ</span></div>
              </div>
              <div class="help-row"><span id="minDateDisplay"></span></div>
              <div id="minDateHelp" class="sr-only">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡πÄ‡∏£‡πá‡∏ß‡∏Å‡∏ß‡πà‡∏≤‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏´‡∏ô‡∏î</div>
            </div>
          </div>

          <hr />
          <div class="section-title">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏¢‡∏≤‡πÅ‡∏•‡∏∞‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ì</div>
          <div class="form-group">
            <label for="medication">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏¢‡∏≤‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡πÉ‡∏ä‡πâ</label>
            <select class="form-control" id="medication" name="medication" required>
              <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å ‡∏´‡∏£‡∏∑‡∏≠‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏¢‡∏≤‚Ä¶</option>
            </select>
            <div class="invalid-feedback">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏¢‡∏≤</div>
          </div>

          <div class="form-group">
            <label for="quantity">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏ï‡πà‡∏≠‡∏£‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏Å‡∏©‡∏≤ ‡πÅ‡∏•‡∏∞‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏£‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏Å‡∏©‡∏≤</label>
            <input type="text" class="form-control" id="quantity" name="quantity" placeholder="‡πÄ‡∏ä‡πà‡∏ô 2 ‡∏Ç‡∏ß‡∏î x 6 ‡∏£‡∏≠‡∏ö" required />
            <div class="invalid-feedback">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏∞‡∏ö‡∏∏‡∏à‡∏≥‡∏ô‡∏ß‡∏ô</div>
          </div>

          <div class="d-flex align-items-center flex-wrap gap-2">
            <button type="submit" id="btn" class="btn btn-primary btn-lg">‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
            <a id="resultLink" href="https://drugpurchasing.github.io/Drug-master/NS-list.html" class="btn btn-outline-primary ml-2">‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</a>
          </div>

          <div id="formResponse" class="mt-3"></div>
        </form>

        <div class="mt-3 text-muted">‡∏´‡∏≤‡∏Å‡∏ó‡πà‡∏≤‡∏ô‡∏û‡∏ö‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô ‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÄ‡∏ö‡∏≠‡∏£‡πå <strong>02-576-6096</strong></div>
      </div>
    </div>
  </main>

  <footer>
    <hr style="border-color: rgba(255,255,255,.25)" />
    <div id="footer" class="footer-note">(Version 2.00 // 25/08/2025) Non-stock form ‚Äî HTML+JS only (Sheets+Email via Apps Script Web App)</div>
  </footer>

  <script>
    // =====================
    //  CONFIG ‚Äî Apps Script Web App (no GCP project)
    // =====================
    const APPS_SCRIPT_ENDPOINT = 'https://script.google.com/macros/s/AKfycbyHwrTbKqadiLpde_RX4UwXBFsESiqAFMSVGz512OjjbrkYHAPy6P5GceIX5WcsgE3lig/exec'; // e.g. https://script.google.com/macros/s/XXXX/exec
    const APP_SHARED_KEY = 'SSS';

    $(document).ready(function () {
      $('#medication').select2({ width: '100%', placeholder: '‡πÄ‡∏•‡∏∑‡∏≠‡∏Å ‡∏´‡∏£‡∏∑‡∏≠‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏¢‡∏≤‚Ä¶' });
      loadMedicationOptions();
      setMinDate();
      $('#dateNeeded').datepicker({ dateFormat: 'DD dd/MM/yy', minDate: calculateMinDate(), onSelect: function (dateText) { $('#dateNeeded').val(dateText); } });

      $('#myForm').on('submit', function () {
        const required = $(this).find('[required]');
        required.each(function(){ this.value ? $(this).removeClass('is-invalid') : $(this).addClass('is-invalid'); });
        if($('#patientHN').val() && !/^\d+$/.test($('#patientHN').val())){ $('#patientHN').addClass('is-invalid'); }
      });

      $('input, select').on('change keyup', function(){ $(this).removeClass('is-invalid'); });
    });

    function loadMedicationOptions() {
      const medications = ['Abacavir GPO (Abacavir) 300 mg FCT (Non-stock)','Abrysvo (‡∏ß‡∏±‡∏Ñ‡∏ã‡∏µ‡∏ô RSV) 120 mcg vaccine prefilled syr (0.5 mL)','Alecensa (Alectinib) 150 mg cap (Non-stock) (‡∏Ç‡∏£‡∏Å ‡πÄ‡∏ö‡∏¥‡∏Å‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ) (NED)','Alunbrig (Brigatinib) 30 mg FC tab (Non-stock) (‡∏Ç‡∏£‡∏Å ‡πÄ‡∏ö‡∏¥‡∏Å‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ) (NED)','BICNU (Carmustine) 100 mg inj. (Non-stock)','Bioferon (Interferon alpha-2b) 3 MU inj. (Non-stock) (NED)','Brukinsa (Zanubrutinib) 80 mg cap (‡∏Ç‡∏£‡∏Å ‡πÄ‡∏ö‡∏¥‡∏Å‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ) (NED)','Cabometyx (Cabozantinib) 40 mg FC tab (Non-stock) (‡∏Ç‡∏£‡∏Å ‡πÄ‡∏ö‡∏¥‡∏Å‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ) (NED)','Cabometyx (Cabozantinib) 60 mg FC tab (Non-stock) (‡∏Ç‡∏£‡∏Å ‡πÄ‡∏ö‡∏¥‡∏Å‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ) (NED)','Calquence (Acalabrutinib) 100 mg cap (Non-stock) (‡∏Ç‡∏£‡∏Å ‡πÄ‡∏ö‡∏¥‡∏Å‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ)  (NED)','Cyramza (Ramucirumab) 100 mg/10 mL inj. (Non-stock) (‡∏™‡∏≥‡∏£‡∏≠‡∏á‡∏à‡πà‡∏≤‡∏¢) (NED)','Cyramza 500 mg/50 mL inj. (Ramucirumab) (Non-stock) (‡∏™‡∏≥‡∏£‡∏≠‡∏á‡∏à‡πà‡∏≤‡∏¢) (NED)','Dacogen (Decitabine) 50 mg inj. (Non-stock) (‡∏™‡∏≥‡∏£‡∏≠‡∏á‡∏à‡πà‡∏≤‡∏¢) (NED)','Dactinomycin 0.5 mg (Lyovac Cosmegen) inj. (Non-stock)','Dasatinib (Sandoz) 50 mg FC tab (Non-stock) **(OCPA)**','Dasatinib 70 mg (Sandoz) FC tab (Non-stock) **(OCPA)**','Decitabine (Decitex) 50 mg inj. (Non-stock) (‡∏™‡∏≥‡∏£‡∏≠‡∏á‡∏à‡πà‡∏≤‡∏¢) (NED)','Dupixent (Dupilumab) 300 mg/2 mL prefilled syr (Non-stock) (‡∏Ç‡∏£‡∏Å ‡πÄ‡∏ö‡∏¥‡∏Å‡πÑ‡∏°‡πà‡πÑ ‡∏î‡πâ) (NED)','Enhertu (Trastuzumab deruxtecan) 100 mg inj. (‡∏Ç‡∏£‡∏Å ‡πÄ‡∏ö‡∏¥‡∏Å‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ) (NED)','Erleada (Apalutamide) 60 mg FC tab (‡∏Ç‡∏£‡∏Å ‡πÄ‡∏ö‡∏¥‡∏Å‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ) (NED)','Florinef (Fludrocortisone acetate) 100 mcg tab (Non-stock)','Gavreto (Pralsetinib) 100 mg cap (Non-stock) (‡∏Ç‡∏£‡∏Å ‡πÄ‡∏ö‡∏¥‡∏Å‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ) (NED)','Gazyva (Obinutuzumab) 1 g/40 mL inj. (Non-stock) (‡∏™‡∏≥‡∏£‡∏≠‡∏á‡∏à‡πà‡∏≤‡∏¢) (NED)','Hexaxim 0.5 mL prefilled syr (‡∏ß‡∏±‡∏Ñ‡∏ã‡∏µ‡∏ô‡∏£‡∏ß‡∏° 6 ‡πÇ‡∏£‡∏Ñ) (Non-stock)','Igamad (Human anti-D ig) 750 iu/1 mL prefilled syr','Imjudo (Tremelimumab) 300 mg/15 mL inj. (‡∏Ç‡∏£‡∏Å ‡πÄ‡∏ö‡∏¥‡∏Å‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ) (NED)','Immunate (Octocog alfa) 500 iu inj. (Non-stock)','Jevtana (Cabazitaxel) 60 mg/1.5 mL inj. (Non-stock) (‡∏™‡∏≥‡∏£‡∏≠‡∏á‡∏à‡πà‡∏≤‡∏¢) (NED)','Jinarc (Tolvaptan) 30 mg tab (‡∏Ç‡∏£‡∏Å ‡πÄ‡∏ö‡∏¥‡∏Å‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ) (NED)','Kyprolis (Carfilzomib) 30 mg inj. (Non-stock) (‡∏™‡∏≥‡∏£‡∏≠‡∏á‡∏à‡πà‡∏≤‡∏¢) (NED)','Lorviqua (Lorlatinib) 100 mg FC tab (Non-stock) (‡∏Ç‡∏£‡∏Å ‡πÄ‡∏ö‡∏¥‡∏Å‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ) (NED)','Lorviqua (Lorlatinib) 25 mg FC tab (Non-stock) (‡∏Ç‡∏£‡∏Å ‡πÄ‡∏ö‡∏¥‡∏Å‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ) (NED)','Lucentis 0.5 mg/0.05 mL inj. (NED) (Non-stock)','Lumakras (Sotorasib) 120 mg FC tab (‡∏Ç‡∏£‡∏Å ‡πÄ‡∏ö‡∏¥‡∏Å‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ) (NED)','Mabthera (Rituximab) 100 mg/10 mL inj. **‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÄ‡∏Ñ‡∏™** **(OCPA)** (NED)','Mabthera (Rituximab) 500 mg/50 mL inj. **‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÄ‡∏Ñ‡∏™** **(OCPA)** (NED)','Mekinist (Trametinib) 2 mg FC tab (Non-stock) (NED)','Ninlaro (Ixazomib) 4 mg cap (Non-stock) (‡∏Ç‡∏£‡∏Å.‡πÄ‡∏ö‡∏¥‡∏Å‡πÑ‡∏°‡πÑ‡∏î‡πâ)(NED)','Norditropin (Somatropin) 10 mg/1.5 mL prefilled pen','Novorapid penfill (Insulin aspart) 100 iu/1 mL inj. (3 mL)','Nubeqa (Darolutamide) 300 mg FC tab (‡∏Ç‡∏£‡∏Å ‡πÄ‡∏ö‡∏¥‡∏Å‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ) (NED)','Opsumit (Macitentan) 10 mg FC tab (NED)','Piqray 250 Mg Daily Dose FC tab (Non-stock) (‡∏Ç‡∏£‡∏Å ‡πÄ‡∏ö‡∏¥‡∏Å‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ) (NED)','Piqray 300 mg Daily Dose FC tab (Alpelisib) (Non-stock) (‡∏Ç‡∏£‡∏Å ‡πÄ‡∏ö‡∏¥‡∏Å‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ) (N ED)','Plerifor (Plerixafor) 24 mg/1.2 mL inj. (Non-stock) (‡∏™‡∏≥‡∏£‡∏≠‡∏á‡∏à‡πà‡∏≤‡∏¢) (NED)','Pomalyst (Pomalidomide) 4 mg cap (Non-stock) (‡∏™‡∏≥‡∏£‡∏≠‡∏á‡∏à‡πà‡∏≤‡∏¢) (NED)','Rozlytrek (Entrectinib) 100 mg cap (Non-stock) (‡∏Ç‡∏£‡∏Å ‡πÄ‡∏ö‡∏¥‡∏Å‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ) (NED)','Rozlytrek (Entrectinib) 200 mg cap (Non-stock) (‡∏Ç‡∏£‡∏Å ‡πÄ‡∏ö‡∏¥‡∏Å‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ) (NED)','Rybrevant (Amivantamab) 350 mg/7 mL inj. (‡∏Ç‡∏£‡∏Å ‡πÄ‡∏ö‡∏¥‡∏Å‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ) (NED)','Sebivo (Telbivudine) 600 mg tab (NED) (Non-stock)','Simponi (Golimumab) 50 mg/0.5 mL prefilled pen (Non-stock) (‡∏Ç‡∏£‡∏Å ‡πÄ‡∏ö‡∏¥‡∏Å‡πÑ‡∏°‡πà‡πÑ ‡∏î‡πâ) (NED)','Somatuline Autogel 120 mg/0.5 mL (Lanreotide) prefilled syr (Non-stock) (NED)','Supralip NT (Fenofibrate) 145 mg FC tab (NED)','Tabrecta (Capmatinib) 200 mg FC tab (Non-stock) (‡∏Ç‡∏£‡∏Å ‡πÄ‡∏ö‡∏¥‡∏Å‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ) (NED)','Tafinlar (Dabrafenib) 75 mg cap (Non-stock) (NED)','Tanstrive (Selpercatinib) 40 mg cap (NED)','Tecentriq SC (Atezolizumab) 1875 mg/15 mL inj. (‡∏Ç‡∏£‡∏Å ‡πÄ‡∏ö‡∏¥‡∏Å‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ) (NED)','Tecvayli 153 mg/1.7 mL (Teclistamab) inj. (‡∏Ç‡∏£‡∏Å ‡πÄ‡∏ö‡∏¥‡∏Å‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ) (NED)','Tevimbra (Tislelizumab) 100 mg/10 mL inj. (‡∏Ç‡∏£‡∏Å ‡πÄ‡∏ö‡∏¥‡∏Å‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ) (NED)','Uptravi (Selexipag) 1600 mcg FC tab (Non-stock) (‡∏Ç‡∏£‡∏Å ‡πÄ‡∏ö‡∏¥‡∏Å‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ) (NED)','Valvir (Valganciclovir) 450 mg FC tab (NED)','Imatinib (Veenat 100) 100 mg FC tab (Non-stock) **(OCPA)**','Imatinib 400 mg (Veenat 400) FC tab (Non-stock) **(OCPA)**','Voriconazole (Voraiz) 200 mg FC tab (Non-stock)','Xospata (Gilteritinib) 40 mg FC tab (Non-stock) (‡∏Ç‡∏£‡∏Å ‡πÄ‡∏ö‡∏¥‡∏Å‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ)  (NED)','Xpovio (Selinexor) 20 mg FC tab (‡∏Ç‡∏£‡∏Å ‡πÄ‡∏ö‡∏¥‡∏Å‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ) (NED)','Yervoy (Ipilimumab) 50 mg/10 mL inj. (Non-stock) (‡∏™‡∏≥‡∏£‡∏≠‡∏á‡∏à‡πà‡∏≤‡∏¢) (NED)','Yulareb (Abemaciclib) 100 mg FC tab (Non-stock) (‡∏Ç‡∏£‡∏Å ‡πÄ‡∏ö‡∏¥‡∏Å‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ) (NED)','Yulareb (Abemaciclib) 150 mg FC tab (Non-stock) (‡∏Ç‡∏£‡∏Å ‡πÄ‡∏ö‡∏¥‡∏Å‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ) (NED)','Zerpidio (Serplulimab) 100 mg/10 mL inj. (‡∏Ç‡∏£‡∏Å ‡πÄ‡∏ö‡∏¥‡∏Å‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ) (NED)'];
      const sel = document.getElementById('medication');
      medications.forEach(text => { const o = document.createElement('option'); o.value = text; o.textContent = text; sel.appendChild(o); });
    }

    function setMinDate() { const input = document.getElementById('dateNeeded'); const minDate = calculateMinDate(); input.setAttribute('min', minDate.toISOString().split('T')[0]); document.getElementById('minDateDisplay').textContent = `‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏à‡∏±‡∏î‡∏´‡∏≤‡∏¢‡∏≤‡πÑ‡∏î‡πâ‡πÄ‡∏£‡πá‡∏ß‡∏™‡∏∏‡∏î‡∏†‡∏≤‡∏¢‡πÉ‡∏ô: ${formatDateThai(minDate)}`; }
    function formatDateThai(date) { const w=['‡∏ß‡∏±‡∏ô‡∏≠‡∏≤‡∏ó‡∏¥‡∏ï‡∏¢‡πå','‡∏ß‡∏±‡∏ô‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå','‡∏ß‡∏±‡∏ô‡∏≠‡∏±‡∏á‡∏Ñ‡∏≤‡∏£','‡∏ß‡∏±‡∏ô‡∏û‡∏∏‡∏ò','‡∏ß‡∏±‡∏ô‡∏û‡∏§‡∏´‡∏±‡∏™‡∏ö‡∏î‡∏µ','‡∏ß‡∏±‡∏ô‡∏®‡∏∏‡∏Å‡∏£‡πå','‡∏ß‡∏±‡∏ô‡πÄ‡∏™‡∏≤‡∏£‡πå']; const m=['‡∏°‡∏Å‡∏£‡∏≤‡∏Ñ‡∏°','‡∏Å‡∏∏‡∏°‡∏†‡∏≤‡∏û‡∏±‡∏ô‡∏ò‡πå','‡∏°‡∏µ‡∏ô‡∏≤‡∏Ñ‡∏°','‡πÄ‡∏°‡∏©‡∏≤‡∏¢‡∏ô','‡∏û‡∏§‡∏©‡∏†‡∏≤‡∏Ñ‡∏°','‡∏°‡∏¥‡∏ñ‡∏∏‡∏ô‡∏≤‡∏¢‡∏ô','‡∏Å‡∏£‡∏Å‡∏é‡∏≤‡∏Ñ‡∏°','‡∏™‡∏¥‡∏á‡∏´‡∏≤‡∏Ñ‡∏°','‡∏Å‡∏±‡∏ô‡∏¢‡∏≤‡∏¢‡∏ô','‡∏ï‡∏∏‡∏•‡∏≤‡∏Ñ‡∏°','‡∏û‡∏§‡∏®‡∏à‡∏¥‡∏Å‡∏≤‡∏¢‡∏ô','‡∏ò‡∏±‡∏ô‡∏ß‡∏≤‡∏Ñ‡∏°']; return `${w[date.getDay()]} ‡∏ó‡∏µ‡πà ${String(date.getDate()).padStart(2,'0')} ${m[date.getMonth()]} ${date.getFullYear()+543}`; }
    function calculateMinDate(){ const today=new Date(); const target=new Date(today); let wd=0; while(wd<14){ target.setDate(target.getDate()+1); if(target.getDay()!==0 && target.getDay()!==6) wd++; } return target; }

    async function submitForm(){
      const formData = {
        doctorName: document.getElementById('doctorName').value.trim(),
        patientHN: document.getElementById('patientHN').value.trim(),
        patientName: document.getElementById('patientName').value.trim(),
        dateNeeded: document.getElementById('dateNeeded').value.trim(),
        medication: $('#medication').val(),
        quantity: document.getElementById('quantity').value.trim()
      };

      if (!/^\d+$/.test(formData.patientHN)) { Swal.fire({ icon:'error', title:'‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î', text:'HN ‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç' }); return; }
      if (!formData.doctorName || !formData.patientName || !formData.dateNeeded || !formData.medication || !formData.quantity){ Swal.fire('‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö','‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏Å‡πà‡∏≠‡∏ô‡∏™‡πà‡∏á','warning'); return; }

      const confirmDlg = await Swal.fire({ title:'‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°?', text:'‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡πà‡∏≠‡∏ô‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô', icon:'warning', showCancelButton:true, confirmButtonText:'‡πÉ‡∏ä‡πà, ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô', cancelButtonText:'‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å' });
      if (!confirmDlg.isConfirmed) return;

      try {
        // ‡∏™‡πà‡∏á‡πÑ‡∏õ Apps Script (‡πÉ‡∏´‡πâ Apps Script ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ä‡∏µ‡∏ï + ‡∏™‡πà‡∏á‡πÄ‡∏°‡∏•)
        await fetch(APPS_SCRIPT_ENDPOINT, {
          method: 'POST',
          mode: 'no-cors', // fire-and-forget ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏´‡∏•‡∏µ‡∏Å‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á CORS ‡∏Ç‡∏≠‡∏á Apps Script
          headers: { 'Content-Type': 'application/json', 'X-APP-KEY': APP_SHARED_KEY },
          body: JSON.stringify(formData)
        });

        const minDate = calculateMinDate();
        const swalHtml = `<p>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡∏™‡πà‡∏á‡∏°‡∏µ‡∏î‡∏±‡∏á‡∏ô‡∏µ‡πâ:</p>
          <p><strong>‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏• ‡πÅ‡∏û‡∏ó‡∏¢‡πå‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏¢‡∏≤:</strong> ${escapeHtml(formData.doctorName)}</p>
          <p><strong>HN ‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢:</strong> ${escapeHtml(formData.patientHN)}</p>
          <p><strong>‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏• ‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢:</strong> ${escapeHtml(formData.patientName)}</p>
          <p><strong>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏¢‡∏≤:</strong> ${escapeHtml(formData.dateNeeded)}</p>
          <p><strong>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏¢‡∏≤:</strong> ${escapeHtml(formData.medication)}</p>
          <p><strong>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ (‡∏ï‡πà‡∏≠‡∏£‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏Å‡∏©‡∏≤):</strong> ${escapeHtml(formData.quantity)}</p>
          <p style="color:red;font-weight:bold;font-size:18px;">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏à‡∏±‡∏î‡∏´‡∏≤‡∏¢‡∏≤‡πÑ‡∏î‡πâ‡πÄ‡∏£‡πá‡∏ß‡∏™‡∏∏‡∏î: ${formatDateThai(minDate)}</p>
          <a href="https://drugpurchasing.github.io/Drug-master/NS-list.html" class="btn btn-primary mt-3">‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</a>`;

        Swal.fire({ title:'‡∏™‡πà‡∏á‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢!', html: swalHtml, icon:'success' });
        document.getElementById('formResponse').innerHTML = swalHtml;
        document.getElementById('myForm').reset();
        $('#medication').val(null).trigger('change');
        setMinDate();
      } catch (err) {
        console.error(err);
        Swal.fire('‡∏™‡πà‡∏á‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à','‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•','error');
      }
    }

    function escapeHtml(str){ return String(str).replace(/[&<>"']/g, s=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;','\'':'&#39;'}[s])); }
  </script>
</body>
</html>




